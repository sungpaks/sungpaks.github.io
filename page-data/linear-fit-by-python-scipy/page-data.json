{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/linear-fit-by-python-scipy/","result":{"data":{"site":{"siteMetadata":{"title":"조성개발실록"}},"markdownRemark":{"id":"84f52241-7bfc-5d32-9496-0e06d1d776bc","excerpt":"…","html":"<p>그 왜 이런거 본적 있으시죠?</p>\n<p><a href=\"https://www.analyticsvidhya.com/blog/2021/10/everything-you-need-to-know-about-linear-regression/\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 626px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.645569620253163%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABC0lEQVR42i2QW2+DMAyF+f//aG+rtJdeJk1rH0pFCYUWKEmaC1BIHJK5S/1kfcdHx3ZijJFShhC89+G/ACCS8AZhmiat9Vv1ASyExWGfoMAYi+Y47ACaurkP8HTBuBcbx1EIEc3c+NWRwmxeZkxWSmHXW19q2BZyAUuu7ebMthdFnwtKOBOTMfbQjF/Hbn7hkFhjmFBnuaxOj03a7is5GMeFLLX7KeVnyn/biQ+z0poMYVv1HwdKhIlbJLhkXlx3Gf3OWdcj9RYspdR7N9gl49OedINStztfn7p12mZsmsFZPBvNi/eo0XuTFZeckKqqOOe613XTXgpCclLXtwfngvMyz84FsvxalfEFf7kcUsIvn7WHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"fitting 예시\"\n        title=\"\"\n        src=\"/static/694cad11b5e1532fd028d26c555d4941/af590/image.png\"\n        srcset=\"/static/694cad11b5e1532fd028d26c555d4941/c26ae/image.png 158w,\n/static/694cad11b5e1532fd028d26c555d4941/6bdcf/image.png 315w,\n/static/694cad11b5e1532fd028d26c555d4941/af590/image.png 626w\"\n        sizes=\"(max-width: 626px) 100vw, 626px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></a></p>\n<p>위와 같이 데이터들 막.. 찍어놓고, 적당한 선 쭈욱 그어서 \"이런 분포를 따릅니다\" 라고 하는 것 말입니다<br>\n당연하지만 그냥 사람이 대강 선을 그어내는게 아니라<br>\n적당한 수학적 방법으로 데이터를 가장 잘 표현하는 함수를 구하게 됩니다</p>\n<p>그런 과정을 두고 <em>데이터를 fitting한다</em>라고 하는데</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 273px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bc8f292e8038dd3a80a177cac7d8162b/0217c/image-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.72151898734178%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAADV0lEQVR42g3LWVMaBwAA4J30wZpOM06fOn3MW6btTJyJGavGRNtEVA5FIjdyKYRFrmU5FpeVZTlWEOu6XIICQRBB0CoV2lrBAonp1NaXvnT6Y9rv/QMY09ynIxODQyNyFYxYcJ1EscJb0AiEK3yBViw1LalRtcapkHve6HV8oUHIJw1GbGXZKhYliAAw/pL/+MnY14PDPL7Oj2xKmXPg6wVIIjUKREaRBJIuoUpwXSkPGyBYLIXFYp9W59eBmEIdX/MALI56aPTV0PBzzrw6GS6gyyCmUgXB1SAIrqlWw5qXJeuXRehxxAxjKjWpN22ZIRJc3dAboy4HwOSCw88Yw6OTsyzZ1kaJRkNbRhMF22gbQqw6i5ZHPQxoYQNR2ETqoZjdtevCwgYTZYYoIgLMLBjGJpjPXjCmpkWoO+N1RGjY/v/Muh1R1XhWO/B7sL8Bf5ayimmrJeFAk841ygLtI+heOAWo1K4X33EZU1zGjMSL5ylvPAbbYw68ss7LMYCd0U9yjP74yINrz0dFVJ5C/Uknsuf2JtBgic4BDnN4lqVgzwpnmFLSf7jv30nabUkEyyNvLp0Dv0IfH0vvn2g/PfNMFYlACkELoXQhepKjat36H4DHvc/l6eZYEg5bjrj2spvZfacz4/bXMP4Nce9D4P7tBtBYHyyQqTzmyWLEQTh3FDs9Tl7ctv8Bwv6SSGyZZ8vmWUsafaScOi8Tvkpwux7Q3Hjv3fj6e+tAEx8vk1Te7SrgvhQRe7sRr2zn7i5vARLPCMUWHlvGYUrkSqya/aVKkocEUSLIuvNh19PXwfqyhqHgshKXzjkXp8FFgVWwiKuVPxQuANydeS1xMZhL82yJTGarFd53j+qXmVKn2mmn0Sb2sBX46szHf+unopDBrxLBC6/07EnF5JOELwQcbCZpgtboQrOLphnOSnmveXdx3Sv/2D06byXdTXyw4fi8ncb/bP971/r7Xe3qKlu6zpcbVKyZiANFL36ZyXWqP9OhglYXjEVOr/LH7yu1dwe59u5ON59vbhNNmuqVTz+cNP6qt3ql4xzMsnEeFT1S4DwW/14zRvC+iJsnKqnqUfqn3fBhMUBeRLc7mTRtFAVlT6sBzW+peHOLOCPt+4jM/m0f/M2DQ+P4fwnIlc0gmT5EAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"옷입기\"\n        title=\"\"\n        src=\"/static/bc8f292e8038dd3a80a177cac7d8162b/0217c/image-1.png\"\n        srcset=\"/static/bc8f292e8038dd3a80a177cac7d8162b/c26ae/image-1.png 158w,\n/static/bc8f292e8038dd3a80a177cac7d8162b/0217c/image-1.png 273w\"\n        sizes=\"(max-width: 273px) 100vw, 273px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>물론 이렇게 옷 입는 그 피팅은 아닙니다</p>\n<p>아무튼 그런 방법들 중 가장 기초적인 임플란트가 <strong>Least Square</strong> Method 입니다\n<a href=\"https://youngji.medium.com/%EC%B5%9C%EC%86%8C%EC%A0%9C%EA%B3%B1%EB%B2%95-least-squared-method-f7357990329f\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 280px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.55696202531645%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABoElEQVR42nVS0W6jMBDM//9UHypV6kNaKSHXSEnriEKAgA3YxmAMpmMMuaq9mwfYAY9nd7SbaZq6rlNKtTPUjPafwLnOvZumwZlhGDbWWikkqnEGKK4bfwEHdKt72DQqD6O6rhYxbsJvaFAEQbDf77MsA7UzUCghiyjmjPGyhHPJijxJV2cpvRgcNecc/Xk6mEE3qipymiUZIeHxlMdZ+pkkYWyM2biLlfINex/nOY6m05zSuig4LdIoItsdeTvFJGLpjVKGWJwzLvDOd/NWNsitiK/JB8nihOyP5PVA01tMLqJkxgz5ZyQFd+KqqqQQ3tf0PUviKDjc4uvHa3DZHWmeX9/P0KDz6+nMsxxTgapGLjO73I25ncnlZXd+2r4/b8PdQXEhGJVlhaARcitF32k3jjFIUnedn9nWQoYvwenhsaZ1U5VG68H097RXODquuSBzJ0aJzpM/b0apaYlrFi7FN9i/vFudp7qseF1jS/BJr+i/4QeFTAiBws3s17PXvWqV30JQCPBkjOGQX9v7Frtfzbqe1v7ob4F3mP4Da+0XdUXrwJaZmGkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"최소제곱법\"\n        title=\"\"\n        src=\"/static/200c92cb34804c5c0c5209cd2b6a26b7/908b1/image-2.png\"\n        srcset=\"/static/200c92cb34804c5c0c5209cd2b6a26b7/c26ae/image-2.png 158w,\n/static/200c92cb34804c5c0c5209cd2b6a26b7/908b1/image-2.png 280w\"\n        sizes=\"(max-width: 280px) 100vw, 280px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></a>\n이런 식으로, 그냥 쉽게 말해서 함수로부터 각 지점들까지의 차이를 최소화하려는 방법입니다<br>\n자세한 설명은 나무위키같은거나 <a href=\"https://www.geeksforgeeks.org/least-square-method/\">이런 데를</a>확인해보세요</p>\n<p>아무튼 이런거 하려면 수식을 막 세워야할 것 같지만<br>\n우리에게는 콤푸타가 있습니다<br>\nPython을 쓸거고,<br>\n그래프 그리는 데는 Matplot 라이브러리를,<br>\n수학통계적인 계산은 scipy한테 맡겨버리기로 합시다</p>\n<h1>예제</h1>\n<p>1부터 10까지의 x값과 그에 대응하는 y, 그리고 yerr(y값의 오차)가 아래와 같이 주어졌다고 해봅시다</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">1 0.000105532 5.12821e-05\n2 0.000281377 5.12821e-05\n3 0.000437138 5.12821e-05\n4 0.000595329 5.12821e-05\n5 0.000623162 5.12821e-05\n6 0.000735304 5.12821e-05\n7 0.000838319 5.12821e-05\n8 0.000911662 5.12821e-05\n9 0.00124201 5.12821e-05\n10 0.00137106 5.12821e-05</code></pre></div>\n<p>x y yerr(또는 uncertainty) 와 같은 형태입니다<br>\n일단 이거 가져다가 파싱을 좀 해봅시다 :</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> scipy<span class=\"token punctuation\">.</span>optimize <span class=\"token keyword\">as</span> opt\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n\n<span class=\"token comment\"># 데이터 불러오기 및 파싱</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"linear.dat\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">:</span>\n    lines <span class=\"token operator\">=</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>readlines<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nx <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\ny <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nuncertainty <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> line <span class=\"token keyword\">in</span> lines<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        parts <span class=\"token operator\">=</span> line<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>parts<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">raise</span> ValueError<span class=\"token punctuation\">(</span><span class=\"token string\">\"Invalid format: Insufficient data\"</span><span class=\"token punctuation\">)</span>\n\n        x<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>parts<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        y<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>parts<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        uncertainty<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>parts<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">except</span> ValueError <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span> <span class=\"token comment\"># 혹시 빈 문자열 등 포맷에 맞지 않는 행이 나오면 넘김</span>\n      <span class=\"token comment\"># 별 일 안할 것임</span></code></pre></div>\n<p>이런거 매번 기억 안 나도 GPT한테 \"\"linear.dat\"파일 열어서 저런 포맷 파싱해줘\" 하면 알아서 짜줍니다.<br>\n이렇게 해서 각 x, y, uncertainty 배열들을 만들어두도록 합시다</p>\n<p>근데 데이터가 대충 어떻게 생겨먹었는지 알아야 어떤 모양에 맞출지도 알 수 있겠죠?<br>\n점을 찍어봅시다</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plt<span class=\"token punctuation\">.</span>errorbar<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">,</span> yerr<span class=\"token operator\">=</span>uncertainty<span class=\"token punctuation\">,</span> fmt<span class=\"token operator\">=</span><span class=\"token string\">'o'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>이러면 y오차와 함께 데이터 그래프를 찍어주고, <code class=\"language-text\">fmt='o'</code> 옵션으로 인해 데이터가 그냥 똥골뱅이로 표현됩니다</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 573px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4a60ec78304b5af2f533f3dc808654b5/3c024/image-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.15189873417721%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAABA0lEQVR42pWR23KDMAxE/f/fGQYCNpbvd9NlaNOUZhqqF8uII621zHvPOTfG5JzTtag5Sxuk0iyEsCyLc27btt779i5a76U1FYpUhmHmNE3X4VjqrCMS5zwrpYCH+O2fAYRprYdhAP92MorK58dvOxxjnOfZWnuCT33uOuTahE1nGNt++ebjsrpEPoNsP6s7DGwcx9NkHNwkiASJa239t5wdPqx6hl0qOF2qtfdv7OXCgGFhB3wIu6v4rLD/sW1YBfKwir50XvD70yoz3G4raZvqY/hVn/FmIThfSbrUWy31UrTWoJehgZQSLVIMpPZAjo9CCBiBHFUiQoIrVosS3EVCRB9i1jYpHmh6lAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"original data\"\n        title=\"\"\n        src=\"/static/4a60ec78304b5af2f533f3dc808654b5/3c024/image-3.png\"\n        srcset=\"/static/4a60ec78304b5af2f533f3dc808654b5/c26ae/image-3.png 158w,\n/static/4a60ec78304b5af2f533f3dc808654b5/6bdcf/image-3.png 315w,\n/static/4a60ec78304b5af2f533f3dc808654b5/3c024/image-3.png 573w\"\n        sizes=\"(max-width: 573px) 100vw, 573px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>직선 긋고 싶게 생겼죠?</p>\n<h1>scipy.optimize.curve_fit</h1>\n<p>이제 이 데이터들을 가장 잘 표현하는 함수를 알고 싶은건데</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 150px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/67c2b1db0c98d93fbf3bb46915892c52/8a4e8/image-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEhElEQVR42h2S+VcSCxTH5096v1bPl+JWZJoImksupJkvy42KVEjJUEmSfQARCIkQHGRTUVaBYQYGZpgV9877Tx6nH+65537v/Zx7zz1fIDfHRz88Q6WdpfeC7NTj5HRrVvII/fYUXenKzXcjyz1FWRe6+fRc1pz/3Jqda0kNNSfHWpIvWnKzj4DUFK+eUEknMt+VET9KvGrNvX5MrfNxeTsy1V5a4BOf+GVl4/lSY07WdjraGBP8fSZoig/w0jPNQGTgXma2tTDDh2c7EuK29Ejj6XjLj5WXm4olhfzzyuqyakWyqxiOSXnop6ZIz/0j/oPY04bUMC8m/geI8O8n3/Jy80/yc52Z8VbD66GJTb1IDwlNhwJrUGAJdpvDQuP+uNq8Lf033H4v9uTBcffD01HecW8DEH3WEBtrgOUdqKTru3ReaPCJrIdCSx3295v8IoNXZPQPggd95oDQFFh6u3AsaIg/bzkeepgQNwHpmabjvkZM2eFemxLqvIOgv8/gHda6pq0+od494wjN7XhFmr26PgD6BNbA9vRUdqg5JuYVZQIgr+jIvHmck3YuaPQ91lCPCerTeSKJLILk13b2k+cwjhY+2UOdmv1+0N9rDb9UWUKv+GWZoKzsB1CViNgQBmRj/VpPt/qn2PBrwxO9uriscXQ6lcLL2N3V5VEiv+CEhrWenu2fvcaA/cvcteEFrn4OUOAoBw7uayW9Or8OimbhfB5Gb6+uHY4fZrtNbzCQFAWjhQIKo0hx0x9+ooWMprVb+2sSFAM0OPHb/WbPsLjogG44jqapQgEu47hJo1FNvNMurxZKxXwuV6lUGIaqYuiU2asyKX/vT1dNrwBM/fLaNx+2Sz3RGFZEU+k0QeDsRS0bOZb/1RbYBrnrK4ai6zCCojWONR+eWS2rd9A86XwDkLZ3rF+KQ0vhoB8pYqVSiSAIlmU5lk0exao4znEcQzN1sYyV6m1X6CTpW7uJylivFKB+SuiInEtsZKPmfC5bHyKpKsMwdZigSYok2XrxJwowAiNFCLIyqW/s6SoTkQDswSITU3IZDYeYYye+YrHC1Vjmz+ZyqUSS1foVFE1jVZwhqrlMnMzbL2ADk15n4h+AWljBJtQXBT2O2CaNziXXYTyRrGAlkmMwvEqQLMnS5UqlGE+A+8FJox2GXVeYhcmp2LM1gDlRshnNBb4Dw45BnbvbBI0oQZ3ki2tJeWDRB11az9etHZl6UrLRpXb26L3BhPOO/kEjJjqlBpj4FpMHaxUnS3re79pFYFCkc/tDyaRrD5S3ORXNYfBbNofWzSOyQCOgO4v6LikPidrIcx3ApdQXqIUlXHdXB7agS7C116n59TVwdH3N7GyOqpfbq9jZCVoVbnueaX2ztt2729DtDXRH79GwHmAyWq60y1b3/rsJuMOO0W2XxHW4aA9iFSJ/noqfRRiKsAZOJDZowRYY3wKtjvXvOrnHvUEXzAB7rmPLuxzlqdU8Co9r0OiPnsXx+osqFaJaJSkaJ4i67bAi8tF5IFi3vf2sejHxTtA/Njk+8D+67OiagdlMbwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"도라에몽\"\n        title=\"\"\n        src=\"/static/67c2b1db0c98d93fbf3bb46915892c52/8a4e8/image-4.png\"\n        srcset=\"/static/67c2b1db0c98d93fbf3bb46915892c52/8a4e8/image-4.png 150w\"\n        sizes=\"(max-width: 150px) 100vw, 150px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>마침 도라에몽이 scipy 라이브러리에 <code class=\"language-text\">curve_fit</code>이라는 좋은 도구를 찾아줬습니다~<br>\n<a href=\"https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html\">공식문서</a>는 에 따르면 <code class=\"language-text\">curve_fit</code>은 least square로 fitting해주는 함수라고 하네요<br>\nleast square에 대해서는 아까 소개했죠?</p>\n<p>인자로는 <code class=\"language-text\">scipy.optimize.curve_fit(f, xdata, ydata, ...)</code> 이런 식인데 (...는 optional들)</p>\n<ul>\n<li><code class=\"language-text\">f</code> : 모델 함수\n<ul>\n<li>직선으로 할거니까 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">y=ax+b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span></span>라는 직선을 가정해봅시다</li>\n<li>그럼 그냥 <code class=\"language-text\">def fit_function(x,a,b) : return a*x+b</code>와 같이 작성해두고, 이 함수를 넘기면 됩니다</li>\n</ul>\n</li>\n<li><code class=\"language-text\">xdata</code>와 <code class=\"language-text\">ydata</code>를 준비해야겠죠? 배열 상태로 준비해둡시다</li>\n<li><code class=\"language-text\">sigma</code> (<em>optional</em>) : 이건 <em>uncertainty in ydata</em>라는데 마침 우리 데이터에는 yerr에 해당하는 <code class=\"language-text\">uncertainty</code>가 있었으니 이걸 넣어줍시다</li>\n</ul>\n<p>그럼 이제 이렇게 쓰면 됩니다</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># 선형 모델 함수 정의</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">fit_function</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> a <span class=\"token operator\">*</span> x <span class=\"token operator\">+</span> b\n\n<span class=\"token comment\"># 선형 모델 fitting</span>\npopt<span class=\"token punctuation\">,</span> pcov <span class=\"token operator\">=</span> opt<span class=\"token punctuation\">.</span>curve_fit<span class=\"token punctuation\">(</span>fit_function<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> sigma<span class=\"token operator\">=</span>uncertainty<span class=\"token punctuation\">)</span></code></pre></div>\n<p>리턴값이 궁금한데요</p>\n<ul>\n<li><code class=\"language-text\">popt</code> : 아까 우리가 모델함수로 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">y=ax+b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span></span>를 정의했고, <code class=\"language-text\">curve_fit</code>을 사용하여 그 모델함수의 <code class=\"language-text\">a</code>값과 <code class=\"language-text\">b</code>값을 정하고 싶었던 것인데, 이 <code class=\"language-text\">a</code>와 <code class=\"language-text\">b</code>에 해당하는 값들입니다.</li>\n<li><code class=\"language-text\">pcov</code> : 이건 <code class=\"language-text\">covariance matrix</code>라는 것인데요.. <em>\"둘 이상 변수들 간의 흩어진 정도(분산)의 상관관계를 나타내는 행렬</em>\" 정도로 이해하고 넘어갑시다.</li>\n</ul>\n<p><img src=\"https://i.imgur.com/LoLbvho.png\" alt=\"\"><br>\n공분산행렬은 대충 이렇게 생겼습니다.</p>\n<p>이 <code class=\"language-text\">pcov</code>에서 얻고자 하는 것은 우리가 얻은 fitting 결과의 오차범위인데</p>\n<blockquote>\n<p>To compute one standard deviation errors on the parameters, use <code class=\"language-text\">perr = np.sqrt(np.diag(pcov))</code></p>\n</blockquote>\n<p>라는 친절한 설명이 있습니다.<br>\n그럼 이 결과들을 이용해서 fitting 결과를 그려봅시다</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># pcov로부터 perr값 계산</span>\nperr <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>sqrt<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>diag<span class=\"token punctuation\">(</span>pcov<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 데이터와 fitting된 모델 그래프 그리기</span>\nplt<span class=\"token punctuation\">.</span>errorbar<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> yerr<span class=\"token operator\">=</span>uncertainty<span class=\"token punctuation\">,</span> fmt<span class=\"token operator\">=</span><span class=\"token string\">'o'</span><span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span><span class=\"token string\">\"original data\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> fit_function<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>popt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span><span class=\"token string\">\"fitted model\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>fill_between<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>\n                 fit_function<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>popt <span class=\"token operator\">-</span> perr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                 fit_function<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>popt <span class=\"token operator\">+</span> perr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                 alpha<span class=\"token operator\">=</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span><span class=\"token string\">\"error band\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">\"y\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">\"Linear Fitting with Error Band\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>적당히 matplot으로 그래프를 그리는 코드를 작성합니다.<br>\n제가 지금 matplot(<code class=\"language-text\">plt.plot</code> 등등..)에 대해 별 설명을 하지 않고 있는데<br>\n저도 그냥 <a href=\"https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html\">공식문서</a>에서 매번 찾아봅니다.<br>\n아무튼 이렇게 적당히 그려보면</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 593px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9dc19a3c844a1f82b27720bc54c65bb2/0b5b1/image-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 76.58227848101265%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAABoUlEQVR42o2T3XKbMBCF/f5v1et2nM7EwS4BhE1I+AchgYWQRI8AO66TtN0LzaLdT3u0WjbTbMYYKeU4jkoprXUcx77vh2Houi4h5Hg8wvc8ryxLJAzDoBQyxw2wPM/TLGuyuEhf94eD4ziAkSGEOM92dWZXqFG+Vfw1Ky2Mvb7jOeUlZSQIULOu6+kLk3rys/YxeClqauGqquq6qtqO9SLPs6IsP8LG2JUP+il8+7bdn9Kq788WZoxRSqHn01IzNelpSmr26JKnICqYwGff9xYG2TTNApuL3fK9VA6Jt473QLKzWkMWRvfQQ/Ts08pIfMmbnwd/60ZJK9R8qLnC6Crn/Fb2HDNKT1zInXf67vgkpbdXeK8MhahcFMVF9hrbhemD87wLkwHHzPvmT1Er3LYt7gwJy25Oux97P4hiLoaPBe9hyLawsD38dUr2HklL+hfsXrZ9asqCYwQY8zn9h73Lbil9jpKKMvukWqt/GXKgd51tGE7COEM/HAwshgxhOMsIwem6DptYlyhscycGp16dZVrwCvpyEfx264RLqZT6DRf9Ye9l3nYAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"결과\"\n        title=\"\"\n        src=\"/static/9dc19a3c844a1f82b27720bc54c65bb2/0b5b1/image-5.png\"\n        srcset=\"/static/9dc19a3c844a1f82b27720bc54c65bb2/c26ae/image-5.png 158w,\n/static/9dc19a3c844a1f82b27720bc54c65bb2/6bdcf/image-5.png 315w,\n/static/9dc19a3c844a1f82b27720bc54c65bb2/0b5b1/image-5.png 593w\"\n        sizes=\"(max-width: 593px) 100vw, 593px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>이렇게 있어보이는 결과가 나왔습니다~</p>\n<hr>\n<p><br>\n되게 뜬금없는 주제였는데요<br>\n데이터분석기법이라는 물리천문학과 수업을 듣다가 그냥 써봤습니다</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9090dbdc2f9ec746b6598718687cee23/5a46d/image-6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.69620253164557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACqklEQVR42gGfAmD9AP///8Xk4pnOydbp5+Ho6cPNyWJhVT0nFF9LNXtzY4WAcXhwYnhvYbakbrObgZKViHSHhp93YqGea4yYgADl5eShy8iYzMfN5+Pm8PHD0M2Ii3lzY1BvYU2Ujn2rmIikfWikeWKObVSNfWukpJh+g32hgGmjoHOKl38AHiAsKSQvMCkyPzxFR0ZOPDk7MCokNDArKikjiH52s5OCp3tkoHJckGpSnYt2qpyFoZZ/npuJn5eIopuHADkcKRQOIBALIAYFGAIBEQAACwAABQYGCQAAAGtSTL2NfJ1tXIdcSn9cR39lU5qIc5eOdZ2WhaCZhJ+ZhgBHJDUoGCkXEiYUEyQnIigvKCE/MiggGRUAAABcSUHPopKgc2aEWUSCWj57YlOUg3KThW6alIOblIKel4UARzMqJRwjCwgeGBQfVkUwblg5dF9HQzgvOTEtdGddq415iWNPdFA4kXpkkYB1mIZ5jIJ0lY59lo9+mJGAAI1HOgkMFgcLGAwLFWlcT4p8bHdqXnNjVmhYS2dWTHdpV3NiS2ZVQG5fUIR0ZJWFeY6GeZqWhpuUh5qTiAB0ODc5ExkqCBAPBguLhYaNg39gUkdtXE1cTDxbTUFpXEiRf19+blFeTjxmVUNvX092bWZybm5ycHFvbnEAgT47YxMuU0BjhISSqLm9mquvj5qahY2WfYOJe42TgZOYmZuWmaSbkqOZi52XipyUgJydkK+2S1FTJSsrANJhVXZCNYGjmMrs9MLh5b7b3sTe4Ka8zZ6xyqGxx5OjwpirxqK7z8Lm5bbg3rbg4LDk6pvN1F5hZTc9PgDfZE/DXTWafTSWk4KIi45wbGlZV1Rycm5oZGBsaGNpZ1uSjXeWkXljYVRjY1hVV0xbZFwoNDI+Pz5gY2EwmiPj6+ibnwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"몰라요\"\n        title=\"\"\n        src=\"/static/9090dbdc2f9ec746b6598718687cee23/5a46d/image-6.png\"\n        srcset=\"/static/9090dbdc2f9ec746b6598718687cee23/c26ae/image-6.png 158w,\n/static/9090dbdc2f9ec746b6598718687cee23/5a46d/image-6.png 300w\"\n        sizes=\"(max-width: 300px) 100vw, 300px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>빅데이터나 AI처럼 데이터를 다루는 분야에서 이런 것들이 되게 기초인 것 같고<br>\n물리천문학과에서도 실험이나 관측 데이터 셋들을 다룰 때 이런게 기초로 많이들 쓰이는 것 같습니다</p>\n<p>좀 대충 쓴 것 같은데<br>\nscipy의 <code class=\"language-text\">curve_fit</code>에 대해 더 알아보고싶다면<br>\n<a href=\"https://www.geeksforgeeks.org/scipy-curve-fitting/\">GeeksforGeeks</a>같은데서 자세히 써놨으니까 참고하십셔</p>\n<p>이만 마칩니다</p>","frontmatter":{"title":"🪢 scipy의 curve_fit 적당히 써보기","date":"May 09, 2024","description":"5분이면 데이터 분석가(인 척)할 수 있습니다","tag":["Python","Data Analysis"]},"tableOfContents":"<ul>\n<li><a href=\"#%EC%98%88%EC%A0%9C\">예제</a></li>\n<li><a href=\"#scipyoptimizecurve_fit\">scipy.optimize.curve_fit</a></li>\n</ul>"},"previous":{"fields":{"slug":"/producer-consumer-problem-and-readers-writers-problem/"},"frontmatter":{"title":"✍️ Producer-Consumer Problem 그리고 Readers-Writers Problem"}},"next":{"fields":{"slug":"/latex-in-gatsby-blog-by-katex/"},"frontmatter":{"title":"💲 Gatsby Blog에서 마크다운 수식(LaTex) 표현하기 - KaTeX 플러그인"}}},"pageContext":{"id":"84f52241-7bfc-5d32-9496-0e06d1d776bc","previousPostId":"1f1f03e1-5579-5c2d-a96e-73e26107fd60","nextPostId":"a636ca08-527a-58bf-b0e7-e93bb45daf0b"}},"staticQueryHashes":["2841359383"],"slicesMap":{}}