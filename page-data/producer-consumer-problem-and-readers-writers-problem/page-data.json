{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/producer-consumer-problem-and-readers-writers-problem/","result":{"data":{"site":{"siteMetadata":{"title":"조성개발실록"}},"markdownRemark":{"id":"1f1f03e1-5579-5c2d-a96e-73e26107fd60","excerpt":"예.. 저번에 Semaphore와 Monitor에 대해 알아봤는데 또 새로운 문제를 해결하는 데에도 쓰인다고 했었죠? 하나는 Producer-Consumer Problem이고 다른 하나는 Readers-Writers Problem…","html":"<p>예.. 저번에 Semaphore와 Monitor에 대해 알아봤는데<br>\n또 새로운 문제를 해결하는 데에도 쓰인다고 했었죠?<br>\n하나는 Producer-Consumer Problem이고<br>\n다른 하나는 Readers-Writers Problem입니다</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b82ea41429b93c264638fabd253d96bc/d67ca/image-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.43037974683544%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACmElEQVR42i3SyW7bZhSGYd6FbYniKDmSNUcTKYqDSFGiKImaEsdo7MJBEiSrBEhQdFV01zvoopuimwK9y7fHbhffjnh4zvcfxTdU4lqNT0uPx8RlWr8mHbdZjFsEgwZhHDN0HQyjRNXWsC0d3dCYdGsckx77pM1h2eGH05o0O6FEtsGbOOLzNuH9KiAevCTzxqxmI9LZmChN8V2XTeiz8EP67Y7gFr9+v+fvP37iz9+/8c9fv/Dbzw94bogSmhqBqjItlRldqYxUnUH5v/R0kyiJ+fT6wPd3P/Lxzb3AEZ2GTa/XwHG6jCcdBoMb2nUDzxMwMiskhk5sGgTyZ1e3mGjmc/qmyTZb8vXtmQ+3Bx7Pr9nPA6miKVNecVW+QFUvsKSOmlXCGQ5QYpkw0QU0DHzBpk/RBK6YDK0qoe/ysA2lhh7rwOGczqW7OS/bdemyhCmxTZWKdkGz2URJBFzohkz5NKHxDHq6jScTjgRM0yUP5zveHbd8OOU87rfspM9Jq063pjGsa4xuTNTKBTfNOspCwFS6Sg2T0HjCJJrxDI4tm2KTcYwC3u9zvtwVnPwuSa+K35RNBAtbUs0LTSa8pNm6RknlDJb/g5HEUy1mZhOvUmViN+QUck5pwm0a8TabcQhG5NMecb/FvNfGbddo2GVUvcRg76MsBVzJqivTJpTekuGY/fFIEqyJgpT17o7NYUHuCFas2W1eMY9CVosVq/mGsN+QF9YoqZd0Bx2UzDJYC5iZFpE8RuqEzKcxCzcidHwyAQ63BXf5glf5juV8T7HNydOtfOvKyjqta5UrAW+67SfQJJfzyCSxoIGsH5g1ZmUDp3rNZnfmeL6nkJMp9meKQg7d68jKdZb9Gknfpl4tc1ku4QUT/gUU/mpVhhwrjwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"두뇌 풀 가동\"\n        title=\"\"\n        src=\"/static/b82ea41429b93c264638fabd253d96bc/f058b/image-1.png\"\n        srcset=\"/static/b82ea41429b93c264638fabd253d96bc/c26ae/image-1.png 158w,\n/static/b82ea41429b93c264638fabd253d96bc/6bdcf/image-1.png 315w,\n/static/b82ea41429b93c264638fabd253d96bc/f058b/image-1.png 630w,\n/static/b82ea41429b93c264638fabd253d96bc/d67ca/image-1.png 714w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>어떤 프라브람이고, 어떻게 해결할 수 있는지 함 봅시다</p>\n<h1>Producer-Consumer Problem</h1>\n<p>I/O버퍼나 Ready Queue 등등와 같이<br>\n하나의 버퍼, 말하자면 어떤 창고가 있다고 해봅시다<br>\n그리고 작업자인 프로세스들은 딱 두 종류만 있는데<br>\n버퍼라는 창고에 넣을 물건인 데이터를 만들어서 버퍼에 집어넣는 생산자인 Producer와<br>\n버퍼에서 데이터를 가져가는 소비자인 Consumer가 있습니다<br>\n이런 특성의 버퍼는 되게 자주 접할 수 있는데<br>\n레디 큐나 I/O버퍼같은 것들이 그것입니다</p>\n<p>아무튼 이제 데이터를 주르륵.. 저장한다고 치면<br>\n다음에 Producer가 버퍼에 쓸 위치는 포인터 <code class=\"language-text\">in</code>으로,<br>\n다음에 Consumer가 버퍼에서 읽을 위치는 포인터 <code class=\"language-text\">out</code>으로 나타내면</p>\n<p>초기 상태는 아래와 같이 버퍼가 빈 상태로 시작한다고 하면</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 591px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/832ffa40fb28d4b16e8dac1df5589b3f/e4c9a/image-26.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.746835443037973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAf0lEQVR42q2RywrFIAxE/f9f1IVPxJXgQgQfUyKkCO29qwrhTCaJEhSlFKy18NURSim01jDnxBgDvffNM8g7fc5Pnym899Baw1p7hzHmQefcJmuaYbIfY4TgS6hIQQ8wyec8hHD3kKYak/tTShBSStRaX1f5tdrflXPOW3z1KRdmpc4BzVtYNAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"과정 1\"\n        title=\"\"\n        src=\"/static/832ffa40fb28d4b16e8dac1df5589b3f/e4c9a/image-26.png\"\n        srcset=\"/static/832ffa40fb28d4b16e8dac1df5589b3f/c26ae/image-26.png 158w,\n/static/832ffa40fb28d4b16e8dac1df5589b3f/6bdcf/image-26.png 315w,\n/static/832ffa40fb28d4b16e8dac1df5589b3f/e4c9a/image-26.png 591w\"\n        sizes=\"(max-width: 591px) 100vw, 591px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>이렇게 <code class=\"language-text\">in</code>과 <code class=\"language-text\">out</code>은 동일한 위치에 있다가</p>\n<p>이제 Producer가 데이터를 좀 쓰고 나면\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 586px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/044eaeb11a078426807616efdaf7696e/a76f4/image.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.0126582278481%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAmElEQVR42q2QzQrEIAyEff/X86L9wYoFC5VehPZQ6ywJpNiFZVlY4SOTzChEhR9PzhnXdX30FZmlFEY01VaLX2uFMQb7vrOWeXtfrevKoWEYGGst+r5H13U34tFca41pmuCc4ypQvywLFIUI7z3ThohxHB/zEAJijFzneb6hPqUERaHjOHgFWfUb718kmt5Q27bhPE/867wAP4jM+StmItwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"과정 2\"\n        title=\"\"\n        src=\"/static/044eaeb11a078426807616efdaf7696e/a76f4/image.png\"\n        srcset=\"/static/044eaeb11a078426807616efdaf7696e/c26ae/image.png 158w,\n/static/044eaeb11a078426807616efdaf7696e/6bdcf/image.png 315w,\n/static/044eaeb11a078426807616efdaf7696e/a76f4/image.png 586w\"\n        sizes=\"(max-width: 586px) 100vw, 586px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<code class=\"language-text\">in</code>이 쭉 이동한 상태고,</p>\n<p>이제 Consumer가 데이터를 읽어가면\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 582px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/31ca312d4345a82a9779809b9dcc4bb6/7c1cd/image-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.278481012658226%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAm0lEQVR42pVRywqEMAzs/39d8Sj0ZVtoe5HiRa2YZbIoIiuyA8Mkk0wOraA/MU0Tbdv2OBetNVqW5eS6ro89DvV9T7VWuudAeKKUQs455jAMrNZa8t6zhhDY01qTUoq6rmP/ug+Fl1L6HkQYRBiKhRgj1whIKVmNMecM/TWHPudMYt93eiIwzzMfAg7v195Ri7dPwBuO43gG3/ABth3Nnruezn4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"과정 3\"\n        title=\"\"\n        src=\"/static/31ca312d4345a82a9779809b9dcc4bb6/7c1cd/image-3.png\"\n        srcset=\"/static/31ca312d4345a82a9779809b9dcc4bb6/c26ae/image-3.png 158w,\n/static/31ca312d4345a82a9779809b9dcc4bb6/6bdcf/image-3.png 315w,\n/static/31ca312d4345a82a9779809b9dcc4bb6/7c1cd/image-3.png 582w\"\n        sizes=\"(max-width: 582px) 100vw, 582px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<code class=\"language-text\">out</code>또한 쭉 이동한 상태가 됩니다</p>\n<p>다시 Producer가 폭주해서 데이터를 쓰되<br>\n만약 버퍼 크기가 <code class=\"language-text\">n</code>이고 버퍼의 끝에 도달하면<br>\n0부터 <code class=\"language-text\">out</code>직전까지는 <code class=\"language-text\">out</code>이 이미 데이터를 읽어갔으니 여기를 또 채워야겠죠?<br>\nRound하게, 끝에 도달하면 <code class=\"language-text\">in = (in+1)%n</code>처럼 해서 0으로 돌아오도록 하고<br>\n다시 쭉 데이터를 씁니다<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 583px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cacd2d9ffae5c08f6bb04f4f2023ecc4/9fc4b/image-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.746835443037973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAlUlEQVR42o2QwQqGIBCEff/ni1I7lCWIh0Q8GGg1Py4UBj+YMOw3u+MelqHxUkoIIRBf19WKg+Wc6VNRzUXHccB7j2EYcJ7na/YvXzwzxqDve0gpIYSgWjPnnHT3xnF8MnW/8LquYNu2QSlFZlkWqre01rSg6zriel54nufHlx3WWrDWTWKMmKbp+w1bgX3f4Zz7vPAHIaHMP4fpFlkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"과정 4\"\n        title=\"\"\n        src=\"/static/cacd2d9ffae5c08f6bb04f4f2023ecc4/9fc4b/image-4.png\"\n        srcset=\"/static/cacd2d9ffae5c08f6bb04f4f2023ecc4/c26ae/image-4.png 158w,\n/static/cacd2d9ffae5c08f6bb04f4f2023ecc4/6bdcf/image-4.png 315w,\n/static/cacd2d9ffae5c08f6bb04f4f2023ecc4/9fc4b/image-4.png 583w\"\n        sizes=\"(max-width: 583px) 100vw, 583px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n버퍼가 꽉 찼네요..<br>\n더 이상 쓰면 Consumer가 읽어가야 할 '니', '다', 등등..의 글자를 덮어쓰게 되니<br>\n이제 버퍼에 데이터를 쓰는 것은 멈추고<br>\n어떤 문제가 발생할 수 있는지 생각해봅시다</p>\n<p><br>\n일단, 한 번에 여러 Producer가 <code class=\"language-text\">in</code>위치에 데이터를 쓰면 안 될 것 같습니다<br>\n당연하죠? \"바보\"를 둘이서 나눠 쓸건데, 같은 칸에 쓰면 \"바\" 또는 \"보\"만 남게 될 것입니다</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 537px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9986433f2cf215fe4704a53dff4cda66/b1cde/image-6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 223.41772151898732%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAtCAIAAAAhntw/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAJwklEQVR42hWWaWxc1RXH3yxv3/c3b5n3Zt6bzTN27PFsnvGsXmI7qx3HjpfxOo6TOImTgJOG0JbsSwmkCVuACAgBCpGKoIICVUPS0opWLVKkfqgqhIpaVFWV+gX1e1+kq6sr3XPO/9z1dwA/6IEhrySQqip5/AAMe2HE64UADwT4YK8f9vggDwR5QdjjWvofjT0EjaE4BEIeAPACOwc7X73c2tzI+rxAgIIkEoRQEEYhGPFgmI9AfTTmo3E/RfhZ0i9SUKYznoxoMg0CBOwZyFhj/V2iSGsU2KWipkSQDCmpMkdBAuGXKUhlQZ2DLR4J82hIxNyBI+OOggMi4c8oqIb7YARMKmgxiBqaIKkiLfOqTEclJCphCQlNqkQqQHaoZNqk0ibTHWTSFgWYLJTTCVvEERRuk7GeICWyGE4Txe7YcCHWreGZIJXXiFyQzgWpnEnmQnQhTJVDdD5MAyEOqoSoDhXjKMTtC2H21MkjZ9Ynz68OjhbtdgXLBMmsjmcMMmfSPSZVsOhcmC7abC7EA46AVMJkzaFLNhuzRE4Rdkzuvv/p3YFNgY4AnjbILp1M62TGJFxZ16YQprMhNm+z2TALxESk4eBDMSopIxhFyIaB0tRUc3aTHcjrWMmmSxZVDZFlh3A1unWsHKFrMa7qMD1u2jEBqkfpPSWzb6R75EiTt2QPRgY0OdNmdqtQb5hqRMh6mKjbpKOQRjAQkPB6nB1qY8sxFrBo78KWrpcuzv/4tStXPvxi4dzG9h9e3n7gwNTxjU1RtcdAixZVcjcpiFXS9tmD44mIkdLJvgRfdDggQPh2V50bR8fHFnc9d+/zt3/x65/f/8M7Hz144fd/qQ6WMwLQG6YbEboUwscL9uUD23fXkmWHa8S5gs0CKumtp9TpwQ4rlli+fPPk9Zunb91+8qVXmk/fCHa0jeZDIymxYWMVm0gHqdb2fKMnkVSxoTbOPTAAwXzJRGj71gGYxAEP4IVAmCQQmsIo3LGNhT3bju7pq0eogIC4d+7565eTne0wTYZ0pmjTAEwREIFjLOUnCRBBfH7QD4NeBM52Rq+dO7GyfjSkCAoBwQSqGObcwhIj8QhFYQxpcgigyIwU4ASBFDhclChZZkSe4lk8rDLFrmgkaik8EZKIoCZYQTXV5mgabxqibaoqiwETOWlPUZkpaWtDkeWqvlTVF0rGTNmarjlzlfBE2S6k9J6kOlG0W/3xZl9iaTB5YCS1Ntw+X0sAE93ck4uFWxdmz7b69leklYq62Ku5Ifb2hxodASnAshKLcbjAoc2qvTKQWGzEz7SGTuwuzJcjwJ4MvzHdfXqt31Veq8mtSmCpoq3UjWbZch0ElU8kY4YVQAjQMZjlwUSrP3FouO3I1mSzFgWm8sJsSZzN8ys1ZW1A29dQFyuB/QPWnqLW5gRunJq/f+vUO5eWt/V38Zo0U48e3ho/vC3x2I7EVK8NbNskNnvl6aK8KytOFuTxvDKaUaaL2lyvdm51y91L+9++sPr6mcV6TwyAPRMlc6nfnqvbe/sjo7kgMJUT5yvKXEmZLwf2VgMLvY/SXqqqq4PhDy42719b+/SZg6//aDaf0kMBcrJizVbtVl/44ObIXDkENHv4Zq/YLMp7y8paXdlXVw7UtVYtsNDQnl0beHH/2CdPr1w9vPnQeG6hZk+UzYW6tTZgHRkKt6oWMJHhZoriXFFqVZXVmtRyN7zqiisLVeX4ZPqZlaHze2tjteh4wVhpGBO95kItuK8RPNRvLlcNYDrDTheF+V5pMSetVgKrFXGtpsz0yNUOZX5rem2s89RSeetgLm5xW3LqVK/RqhmrdeNQf/CRcyUlzJX4Zp7eu0VbbYi7s1IuIepBHuepK6cP3X1m3/2PXi/Wy2pIN2wtEVWHcmarph/sM5ZrBhBNJzMxZu/BgVNvvrv42JTE+yiRYmUKRIDz185//7//3Lh5nVfZcCIYMARZ4xmZHepWjgybU6UA4KSiE6O1J54/efnjL86+/9bCEyenDm9MHDw2t37szO2f3fntH8/evDlz/Ae7j23Mn3lq9dKFiadOj2zJn9imu5camN5Z+ufHFz//7PYn3371u28fPvjb16/cvffCm7+6dffei3c+uvry+5df+vi1D7949f37v/zm7/e+++7O1//Ibxspi56cRgDf/PXL77/76ssPfnrx6UuL64fH1o+NHlif2Tgxvn7s1PXnrt15b+fh9dknT+7e2Nh29PCu4xsjG8fDqWgSBGKIF3jv3Tduv/b8E/OlnR1EUIRpkeZEQrVkMch2drWVSzlZ5xVV4BWaZFDdkAxLCep8FPc5qBegKBTyASgCihILYyBJQCgO+lHQj4Mg4vdBXhgFERyE3YZBuMsV3DWAEcSLucpeD9BXij/7o9mtm4uYD9BpP4P7vLDHZSqGekncR2BeGvcxBMi5iCT9MgOXsu1J2/0MQIBFvaOVtsWpeiwk2aw/b+C2gKKoj6f8HA0LIqkKuMHAQQ6yODQkoLaEORIeV4m4SgIWC2cVFAPd8FBaw+oholPHNQ7SRIwXWUYWSI5OKHiHQbarZKdBdVtMWqdyFpMPcy6r4B6D4GiEJqAulegNUd0GFZeRmEbCFE7LUipmZk0mYzJ5k3ZbzmaKFl0Jc3mbAeIS0ggTcRkPsKgLwYG4G5K2RCwVt9b2zx2cqKzuyKaDbNqkCyaVNelsmMqG6B6by9gckFSwPodoRNiC6ZKBGYwzEZ3RQkGIJE+fP331ieWeMJExXDJTbuiywxQjbM7iXcRmbf6R84BD9Dlk0WKGkkw1TnOyIAR1gCTsRKySiRc1uGGTZdtlHRWR4I4g2R8VahGmGOWBNgmarETmh1NlhxqMkjGTp3U9JjI7aGyMwBIaW7PJWpjsi1EJBc11RhOOngtTIymhFOWAdIh54cLiyz9ZHa84HQGUkziEpfMCfjUmne5UbIlul7HeEFmxqZFS+9XH5ycG01GV7Iu7lGSApE4cnSxeOzY1VnCSAdSL4eVu49bjqQdv5D+70X101OnPaiSF9lWLp/bP7ZsZGa8nXEQOJLice1QGC08PZ0cbXZt0d1W4QKOrk87Da5sevtP19We5h290jQ/rEoM5BhdVqX0zQz3ZVFhG6jE2G2IACEOGhxrx9gSEwzKPlhLi5+fSX95sf3A1+ee30r+50vbi/vZajEdgr2ppy61FXhEhijJV+lFZgVIEwRK0JBA8C2AwRZMnmvF//an33w8r/33Y++GF1FJ/MMDgII4oWiDVkSJZihZ4lqeDDARgJI6SOEJgPth9N27BSFfL5q7NRqOkrDct3aBB0K0gQRBD3FmapQiSpDkWI1HE5/k/Mp8eXSG8GmMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"가만히 계세요\"\n        title=\"\"\n        src=\"/static/9986433f2cf215fe4704a53dff4cda66/b1cde/image-6.png\"\n        srcset=\"/static/9986433f2cf215fe4704a53dff4cda66/c26ae/image-6.png 158w,\n/static/9986433f2cf215fe4704a53dff4cda66/6bdcf/image-6.png 315w,\n/static/9986433f2cf215fe4704a53dff4cda66/b1cde/image-6.png 537w\"\n        sizes=\"(max-width: 537px) 100vw, 537px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Consumer의 상황도 마찬가지겠죠?<br>\n그러니 어떤 순간에 데이터를 읽거나 쓰거나 하나만 하도록 해야 할 것 같습니다.</p>\n<p>근데 이 경우는 이미 앞에서 질리도록 살펴봤던 Mutual Exclusion 문제네요<br>\nWell-Known 입니다만? 🥸</p>\n<p><br>\n또 다른 문제는 일단<br>\nProducer는 버퍼가 가득 차면 데이터를 더 이상 집어넣을 수 없고<br>\nConsumer는 비슷하게, 버퍼가 비어 있다면 데이터를 더 이상 꺼내갈 수 없습니다<br>\n라는 사실에서부터 시작하는데<br>\n그럼 그냥 버퍼가 가득 차면 Producer는 기다리고,<br>\n버퍼가 비어 있으면 Consumer는 기다리면 되지 않을까요?</p>\n<p>근데 위 그림을 다시 자세히 들여다보면<br>\n버퍼가 비어 있는 경우 <code class=\"language-text\">in</code>과 <code class=\"language-text\">out</code>이 같은 자리에 있는데<br>\n버퍼가 가득 찬 경우에도 <code class=\"language-text\">in</code>과 <code class=\"language-text\">out</code>이 같은 자리에 있습니다??<br>\n그렇기 때문에 <code class=\"language-text\">if (in == out)</code> 이렇게 쓰는 것만으로는 버퍼가 비어 있는지 가득 찬건지 확인을 할 수가 없습니다 ㅜㅜ</p>\n<p>그래서 이걸 구분하기 위해 어쩔 수 없이 Producer와 Writers 각각은 다음과 같이 작성해왔습니다</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">void</span> producer<span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>true<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\tv <span class=\"token operator\">=</span> <span class=\"token function\">produce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//대충 data 하나를 만들어 냄</span>\n\t\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>in<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">%</span>n <span class=\"token operator\">==</span> out<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 다음 칸이 out과 겹치면 대기</span>\n\t\t\t<span class=\"token comment\">/* do nothing */</span><span class=\"token punctuation\">;</span>\n\t\tbuffer<span class=\"token punctuation\">[</span>in<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v<span class=\"token punctuation\">;</span>\n\t\tin <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>in<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">%</span>n<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> consumer<span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>true<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>in <span class=\"token operator\">==</span> out<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 현재 칸이 in과 겹치면 대기</span>\n\t\t\t<span class=\"token comment\">/* do nothing */</span><span class=\"token punctuation\">;</span>\n\t\tw <span class=\"token operator\">=</span> buffer<span class=\"token punctuation\">[</span>out<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t\tout <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>out<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">%</span>n<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">consume</span><span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//대충 꺼내온 데이터를 소비함</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>그냥 버퍼를 아무리 꽉 채워도 한 칸은 비우도록 한 것이죠......<br>\n그리고 OS를 잘 공부한 독자라면<br>\nbusy-waiting이잖아? 를 바로 떠올리시겠죠?</p>\n<p>이 문제를 semaphore와 monitor로 잘 해결해볼 수 있습니다<br>\n게다가 얘네를 쓰면 꼭 한 칸 비우도록 하지 않아도 됩니다!</p>\n<h2>Semaphore로 Producer-Consumer Problem 해결하기</h2>\n<p>코드 형태를 바로 봅시다</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> sizeofbuffer <span class=\"token operator\">=</span> <span class=\"token comment\">/* buffer size */</span><span class=\"token punctuation\">;</span>\nsemaphore s <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\nsemaphore n <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\nsemaphore e <span class=\"token operator\">=</span> sizeofbuffer<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">producer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>true<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">produce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//대충 데이터 만드는 함수</span>\n\t\t<span class=\"token function\">semWait</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//데이터 집어넣기 전에, 버퍼 꽉 찼는지 확인</span>\n\t\t<span class=\"token function\">semWait</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//C.S 잠그기</span>\n\t\t<span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//데이터 집어넣기.</span>\n\t\t<span class=\"token function\">semSignal</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// C.S 잠금 해제</span>\n\t\t<span class=\"token function\">semSignal</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 데이터를 집어넣었으니, 하나 넣었다고 알리기</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">consumer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>true<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">semWait</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 데이터 꺼내기 전에, 버퍼 비었는지 확인</span>\n\t\t<span class=\"token function\">semWait</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//C.S 잠그기</span>\n\t\t<span class=\"token function\">take</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//데이터 꺼내가기.</span>\n\t\t<span class=\"token function\">semSignal</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//C.S 구현</span>\n\t\t<span class=\"token function\">semsignal</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//데이터를 꺼냈으니, 하나 꺼냈다고 알리기</span>\n\t\t<span class=\"token function\">consume</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//대충 데이터 소비하는 함수</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">parbegin</span><span class=\"token punctuation\">(</span>producer<span class=\"token punctuation\">,</span> consumer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 때, 가상의 함수 <code class=\"language-text\">append()</code>와 <code class=\"language-text\">take()</code>는 대충 데이터를 집어넣고 꺼내가는 동작이라고 보시면 됩니다</p>\n<p>세 가지 semaphore가 쓰이는데..</p>\n<ul>\n<li><code class=\"language-text\">semaphore s</code> => C.S를 잠가 Mutual Exclusion을 보장하기 위함. 초기값 1</li>\n<li><code class=\"language-text\">semaphore n</code> => 버퍼에 꺼내갈 수 있는 데이터가 얼마나 있는지 나타낸다. 초기값 0 (처음에는 데이터가 없음)</li>\n<li><code class=\"language-text\">semaphore e</code> => 버퍼에 데이터를 넣을 공간이 얼마나 남았는지 나타낸다. 초기값은 <code class=\"language-text\">sizeofbuffer</code>. (처음에는 버퍼 전체가 비어있으므로)</li>\n</ul>\n<p>이렇게 해서,<br>\nproducer는 빈 자리(<code class=\"language-text\">e</code>)를 하나 줄이고 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\rightarrow</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span></span> 데이터 개수(<code class=\"language-text\">n</code>)를 하나 늘리고,<br>\nconsumer는 빈 자리(<code class=\"language-text\">e</code>)를 하나 늘리고 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\rightarrow</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span></span> 데이터 개수(<code class=\"language-text\">n</code>)를 하나 줄이고,<br>\n를 지속적으로 수행하게 합니다.<br>\n이 때,<br>\n만약 더 넣을 빈 자리가 없다면(<code class=\"language-text\">e</code>값 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≤</mo></mrow><annotation encoding=\"application/x-tex\">\\le</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≤</span></span></span></span></span> 0) producer는 <code class=\"language-text\">semWait(e)</code>에서 걸려 대기하고,<br>\n만약 더 가져갈 데이터가 없다면(<code class=\"language-text\">n</code>값 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≤</mo></mrow><annotation encoding=\"application/x-tex\">\\le</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≤</span></span></span></span></span> 0) consumer는 <code class=\"language-text\">semWait(n)</code>에서 걸려 대기합니다.</p>\n<p>이 때 <code class=\"language-text\">semWait()</code>또는 <code class=\"language-text\">semSignal()</code>의 순서가 중요한데<br>\n<code class=\"language-text\">semWait(s)</code>를 <code class=\"language-text\">semWait(e)</code> 또는 <code class=\"language-text\">semWait(n)</code>보다 먼저 놓거나, 하면.. 참사가 벌어집니다<br>\n예를 들어, 제가 실수로 consumer를 <code class=\"language-text\">semWait(s)</code> 다음 <code class=\"language-text\">semWait(n)</code>이 나오도록 작성했다고 칩시다.<br>\n그러면 만약..</p>\n<p>버퍼가 비어 있는 상황이라고 가정하고 흐름을 한 번 봅시다</p>\n<ol>\n<li>먼저 consumer가 <code class=\"language-text\">take()</code>를 위해 접근\n<ul>\n<li><code class=\"language-text\">semWait(s)</code>가 먼저 나왔다고 가정했으므로, <code class=\"language-text\">s==1 -> 0</code></li>\n<li>그 다음, 버퍼가 비어있으므로 <code class=\"language-text\">semWait(n)</code>에 걸려 대기</li>\n</ul>\n</li>\n<li>그 다음, producer가 <code class=\"language-text\">append()</code>를 위해 접근\n<ul>\n<li>버퍼에 빈 공간이 있으므로, <code class=\"language-text\">semWait(e)</code>를 통과</li>\n<li>그 다음, <code class=\"language-text\">semWait(s)</code>에서, <code class=\"language-text\">s==0 -> -1</code>, 값이 음수가 되었으므로 대기</li>\n</ul>\n</li>\n</ol>\n<p>헉.. 둘 다 Block 상태를 빠져나오지 못하는, Deadlock에 걸려버렸습니다<br>\n서로가 서로를 기다리게 되었네요 ㅜㅜ</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 287px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9c8a4d8900efd2b7951f164681a7a63a/480fd/image-7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.75949367088608%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC50lEQVR42gHcAiP9AMCVWcmaWMeeW8qjXIaFhbvDyqaIWsGbYcuiZ8aeY7+ZYMWdYsafZ6iGU7Wyp972/9To8N3x+eH4/+D3/gC7mGDMmlvCmlvIoVqAgH7Eys+niFjBm2LNpGfMpGbMo2fLo2fFoWWmhE68uqrn///Z7fPa8Pjg+P/h+f0AtpllzZpYwJhcxp9ceHp3pay3qoxavplhuZVfuZNevZdhvZhhv5hkq4dTrqqcy+D0xdbh3/T44vr/4vr+ALKZZs6cWsGYWs2mYnV2bX95XbedX8amYs2qZNayatSxacWkYcikYsOiYZuLYJGFZ42BYsPOzez//+b6/ACul2XPoVzFnV6Pd0+xo2niyWrbwmroz3CxnVlUSSuEdUTix2vjxWjjxmzgxGrewmbauF6kmHjb7/bp/v8AsZpq1qlim39Vp5BW4cVk4MBi58ZlwqZcDAsJAAAAAAAAgW9B7Mhq38Bl4sRm4cJk48Bnxalcr7Op6P7/ALGdcJ2JZpWLb8m+f87Ef8G6gdDJirGegEAeGysWECsOCottW9bJj8e7eMzCgMi+gsi8gc3Agqani6SzuwCjpJCewd+ozuqrzuqt0OyxysSkvKemvKjEWEjNOSrKPCuokXWoyLq5zcyxx7+xxLKv0Oar0O2z1/Cw0usAprOqs97/ttz5s9z/w9zmu8mRjq+GoczNxKKGzmM7y4BWpsGut9vjr9PRia+MorZ6wtbQtNv7vuP7v+T+AKq2rLvh+bre9rba9sLSvLHAm7TLxrbOyZylhWt1UpGbfsPVzbPKvaO3lZ+0jq2+lMPRtrXZ9KzP6brd9wCep6Ssvsmvwc6wxNKvwcqxxdG2z9+xw8OluMKAjpiLmaK20uCuxcyxxdC3y9mqt7y1ytWvyNelusmryNsAn6eirsrbsMzfr87kuNTpttPotNjwrtDluNfsweLvrMvksNPut9fqt9bpu9jnrsjWqszgtdbpt9LmstXsnOPiCaMRqkMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"기다릴거야\"\n        title=\"\"\n        src=\"/static/9c8a4d8900efd2b7951f164681a7a63a/480fd/image-7.png\"\n        srcset=\"/static/9c8a4d8900efd2b7951f164681a7a63a/c26ae/image-7.png 158w,\n/static/9c8a4d8900efd2b7951f164681a7a63a/480fd/image-7.png 287w\"\n        sizes=\"(max-width: 287px) 100vw, 287px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Semaphore가 이전의 Software나 Hardware 방식과 비교하여 강력한 것은 맞지만<br>\n문을 잠그고, 키를 두고 가고, 값을 통제하고, .. 를 관리하는 것은 여전히 사람이기 때문에<br>\n이렇게 잘못 사용할 여지가 충분히 남아있습니다<br>\n그럼 Monitor를 사용해본다면?</p>\n<h2>Monitor로 Producer-Consumer Problem 해결하기</h2>\n<p>저번시간에 말한 Monitor란<br>\n한 번에 한 프로세스만 Monitor에 진입하므로 그 자체로 Critical Section이고<br>\n<code class=\"language-text\">cwait</code>, <code class=\"language-text\">csignal</code> 함수와 Block Queue를 가지는 <code class=\"language-text\">condition</code> 변수를 가진다고 했습니다<br>\n그런 Monitor의 특성을 이용하여<br>\n아까 semaphore로 감쌌던, 데이터를 집어넣거나 꺼내는 동작인, <code class=\"language-text\">take()</code>와 <code class=\"language-text\">append()</code>를 작성해봅시다</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">monitor boundedbuffer<span class=\"token punctuation\">;</span> <span class=\"token comment\">//유한한 버퍼 자체가 모니터 안에 포함됨</span>\n<span class=\"token keyword\">char</span> buffer<span class=\"token punctuation\">[</span>N<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">int</span> nextin<span class=\"token punctuation\">,</span> nextout<span class=\"token punctuation\">;</span> <span class=\"token comment\">//다음에 쓸, 또는 읽을 위치</span>\n<span class=\"token keyword\">int</span> count<span class=\"token punctuation\">;</span> <span class=\"token comment\">//버퍼에 있는 데이터 갯수</span>\ncond notfull <span class=\"token comment\">//버퍼가 가득 찬 경우 producer가 기다리는 큐를 포함</span>\ncond notempty<span class=\"token punctuation\">;</span> <span class=\"token comment\">//버퍼가 비어 있는 경우 consumer가 기다리는 큐를 포함</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">append</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> x<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>count <span class=\"token operator\">==</span> N<span class=\"token punctuation\">)</span> <span class=\"token function\">cwait</span><span class=\"token punctuation\">(</span>notfull<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//버퍼가 꽉 참. 기다리기</span>\n\tbuffer<span class=\"token punctuation\">[</span>nextin<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> x<span class=\"token punctuation\">;</span>\n\tnextin <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>nextin <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> n<span class=\"token punctuation\">;</span>\n\tcount<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">csignal</span><span class=\"token punctuation\">(</span>notempty<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//버퍼에 데이터 하나 넣어뒀으니 consumer 하나를 깨운다</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">take</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> x<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>count <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token function\">cwait</span><span class=\"token punctuation\">(</span>notempty<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//버퍼가 비어 있음. 기다리기</span>\n\tx <span class=\"token operator\">=</span> buffer<span class=\"token punctuation\">[</span>nextout<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\tnextout <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>nextout <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> n<span class=\"token punctuation\">;</span>\n\tcount<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">csignal</span><span class=\"token punctuation\">(</span>notfull<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//버퍼에서 데이터 하나 꺼내갔으니 producer 하나를 깨운다</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">append</code>할 때는 혹여 버퍼가 꽉 찼다면 condition 변수인 <code class=\"language-text\">notfull</code>에 producer를 기다리게 하고,<br>\n<code class=\"language-text\">take</code>할 때는 혹여 버퍼가 비어있다면 condition 변수인 <code class=\"language-text\">notempty</code>에 consumer를 기다리게 합니다.<br>\n<code class=\"language-text\">csignal</code>은 조건을 묻지도 따지지도 않고 실행하는데,<br>\n전에도 말했 듯이 condition 변수에는 값이 없으므로<br>\n그저 큐에 기다리는 프로세스가 있으면 깨우고, 없으면 말고, 를 하면 됩니다</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 221px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d46de6777f7296102e9507a6fc617447/cccdc/image-8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 103.16455696202532%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAIAAADJt1n/AAAACXBIWXMAAAsTAAALEwEAmpwYAAADpUlEQVR42iWUyS9rcRTHf3+JrQUrbCQSErEwREQkVmIIwoKkJCJiWpjneVbDvTW05qFKSz1FK8TYZx76nhAxhD4JEQnvc7WLm9vf75zzHc45V5SVlcXExKSlpWVlZbW2tjY3N+/t7TmdzsvLy/39/Z6enoKCgr8/v+np6bm5uc3NTZPJNDExsb6+Lsh0c3MLCwtLTEzMzs4m+vz8/O7u7v7+Xpbl1NRU4paXl6+url5eXp6envr7+xcXFwHgRGRmZoaHh9fU1HR3d9fX11dXVxsMhrGxsY2NDQpFRUXd3NxcX18/Pz9/fn5+fX2Rb7Vaz87Odnd3RW5ubkpKSlFRUUdHx8DAQFtbm8Ph+P7+JnR4eNjHx2d1dfX19RXadrsdOeTwQn5XV5dIT08Hs6SkBMEajYb88fHx7e1trikUERGBC2tra4+Pj5SjaGFhIYzMZvPKyooglDvQysvLiUMSyisqKiIjI3lOTU3V1tY2NTWBg2ENDQ28q9VqjEC2QPf7+zslh4aGPDw8/P39vby8/Pz83N3dMQz8hYUFAPLz85OTkwMDA2dmZnZ2dmZnZ5eWlgTeNDY2AqvX64njCQIXFotlfn5ekiS8QDwkYdHS0tLe3j46Osp7b2+vqKurCwoKotswoYGAwI00SiCBOKPRSEuxIyMjA/Knp6fcEqYYVlpayhjgEPjYACCnQPECC6w+PDxkMEiAqsPxx+n89/b2xpVWqxUIwyf+cEc+oZiMn6RB1TVPk5OTKEKLwaCXZInk33Y7pAR8uDs5OUE83WaY0AkyVtGF4+NjKNBbSZJ1Oq3F8kvWyFabFc9GRkYECeQDghkkUK+qqoo539raQir2QIEhh6ROp3t4eKAvjApGKMn4HBAQgG3YQwkGZnBwEBWIxM/o6GhMOTg44J1DfLq4uIAI1IgXeMtWEEFLGACQEYmlsMAFxAcHB0MKHPSbf36QolXcKshMRXFxMVX7+voogQVsBcNzdHREF1hD2oY0xgP+nOACijhXkkEODQ1lGLGU0SUOz+gCf29vb5Fns9l4IpuFc5XDS7xQtoqlTUpKiouLq6ysZLBpWGdnJ+vpGiyMRQLDTwl6QcMwiPHGFEGTAWd6cnJyCOWTwswAi1oaztjhH7AI5pYczikBuOI2IOydr69vSEgIfnLn7e0NPs4hktUBihgAMAkkqnx8fGCHkpyXl6dSqWJjYxMSEmCOCk9Pz/j4eMRjMlQBhwJpyGE9UcF3yqXiP+WgQQH4Nr/kAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"일어나\"\n        title=\"\"\n        src=\"/static/d46de6777f7296102e9507a6fc617447/cccdc/image-8.png\"\n        srcset=\"/static/d46de6777f7296102e9507a6fc617447/c26ae/image-8.png 158w,\n/static/d46de6777f7296102e9507a6fc617447/cccdc/image-8.png 221w\"\n        sizes=\"(max-width: 221px) 100vw, 221px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>이렇게 간단히 <code class=\"language-text\">append()</code>와 <code class=\"language-text\">take()</code>라는 일종의 proceduer가 작성되었습니다<br>\n이제 producer와 consumer는 단순히 아래와 같이 동작하면 됩니다 :</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">void</span> <span class=\"token function\">producer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">char</span> x<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>true<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">produce</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//대충 x라는 데이터를 하나 만들어서</span>\n\t\t<span class=\"token function\">append</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//집어넣기</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">consumer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">char</span> x<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>true<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">take</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//꺼내와서</span>\n\t\t<span class=\"token function\">consume</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//대충 x라는 데이터를 소비</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">parbegin</span><span class=\"token punctuation\">(</span>producer<span class=\"token punctuation\">,</span> consumer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>진짜 단순해졌습니다<br>\n어랍쇼? Mutual Exclusion은 엿바꿔먹었나요? 라는 생각이 잠깐 들 수도 있지만<br>\n<code class=\"language-text\">append()</code>와 <code class=\"language-text\">take()</code>는 Monitor 내에 정의된 <em>proceduer</em>라서, 이미 그런 것은 보장이 다~ 됩니다.<br>\n또한 저렇게 한 번 정의하고 나면, semaphore에서와 같이 저같은 바보가 잘못 써놓을 일은 없습니다.<br>\n그냥 함수만 콜하면 끝이니까요</p>\n<p>어? 근데<br>\n이전에 semaphore에서 동기화할 때는,<br>\nC.S를 먼저 통과하고 버퍼의 상태를 확인하면 데드락이 발생했었는데..<br>\n이렇게 Monitor로 구현한 방법 역시<br>\nMonitor 내부는 이미 혼자서만 들어가는 C.S인 셈이고<br>\n그 안에서 버퍼의 상태를 확인하므로 데드락 위험이 있는 것이 아닐까요? 싶지만</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 227px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/977e923fba832aae65f871793c8329ee/9b5be/image-10.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.10126582278481%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEm0lEQVR42i3Ra09adxwH8PM69gL2oEkjbdFzQEURyqVeuRwOoKJVrEWq4o1Wg62IiBzAIhQERS26iYIVrYAgRwTRIs5ecE5tm13q5pZsWbcly9Y02bKDWfLP/9nn9/1dgEc9Als3Yu8WmNsqu6qvy6qo2KLji6hvL7yQjiw+C87F/ePxFVtwSjfAg1QVOWruVS1MHIEhsxAEnF1chxJxdvJtCo5KWtrELpgfG0htLKbCnn3MlwrPJf3W+LLF7xpR88kPKgnDPOIIPxcVQBYxCEy0lbm6YFc37Gir0jYyG5mQuVf2LLqwjy09T/j3w66dJUN8aXR5UjMoyB/kXtHhGM5DhZC1GgQm5TemO7lTnVVTiiqTlNFII/bWc5JB94vY4pc7vhcbrrR/dPeJcdXVP4gUaHlEgwDUCyCDkGQR5QHOZubjbr67mzsjZ1saqO2lUEsldX3BnkksHO3MHyXcr9Zt6VXzE/tdLUJG4TwjAqEIji/attZRp1rLH7dXuOUsu5Sm5BXW0SGf23L4zH+S8h4nZjLRiXTA5rX2DCGQUfA/NopIWWyspUw0M2bby+c7yh1N9H5RkbCYMD324M3zp6dJ90nE/jJkTQUeeizdI6KCUYRoQLJtm0Rkq5gM6GsplnrqtLzU01k2dZuhr6fXMXOlMCPkNb/GJtKe+9vue4FJZbuEpeHmmoWQAY8VknA8Js4HRmooZknRdAvb03Fj9g4LL3SbTRSX0dU9d44Clpi1JW5vCznvtzcKh2Do4QU2CUmjovyHONYgRWYJ1XWLNtvKmmtl2W8Wy+kElaw2E5h8+xR9tWY9Ta+dZTYSy5NGSUl2Zjw2i8lZ3CemoWLK+E3ajIz9uIXhlFI72FcVNZU/vQq93PL2KhV9/Q8O356GvS6NoNCE94yA+LVMwgu84hnV1ZRYailTTYwZGdNWX9hbcRVhks7PTz9f9jGpxSxKgXcrvbu/q6uhGQQQvi0UBvGd4+HAVgC1KxEdDDluUmdkrAkpfZAHCUoI6YO9vZNv6BXcMqEkeny2hgUNDTdMIsoInI8nGy8mBxzaWyszA6qK3OzOZdfn5EyLhFpNvWzR92/v7y1EME84uoJF5j0ucwvPICCbxBQUzr3AEKBqKE1GHBpxEV7J0VwyIaON1ec3MXJM91tDAd86th7ZxkKxSBALGJs5Wi7RKKTo+SSjAERhEiBj5Gz4jVYlYmxgZ7ZW3x0fnOxF1a01A201schKGAtHtpPR5G54C0NvcQY513R8Eson48PjPyArueQcblj9TPX2q8xfHz5+9+77337/48cfzgz35Kmttc3YOradiG4nQlgITx6qvDbMI6EwpIdBLRcE5Ncv3xMXxMPaN0cHH//595df3//594ev3xwPdza+PtzfiYfiWHATC8Y2n47d4Wcxn6TjQ/gb5IGAgkVoKPw0Ot83q5Et2XUvN5+klsetrVUKbnEMCx+EF557HyV9tuNM0qGsGygnqPnQEBfUckA1jntYhGriJ/YO0fpon4J+SQ8TrRJwvLG4i1uoktWZmjmHzp736eWfz7913JX2l+fgWMOD1Ly8AT74H2cWU44l9Yt9AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"꺼내줘\"\n        title=\"\"\n        src=\"/static/977e923fba832aae65f871793c8329ee/9b5be/image-10.png\"\n        srcset=\"/static/977e923fba832aae65f871793c8329ee/c26ae/image-10.png 158w,\n/static/977e923fba832aae65f871793c8329ee/9b5be/image-10.png 227w\"\n        sizes=\"(max-width: 227px) 100vw, 227px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Monitor에서 버퍼의 상태를 확인하고 <code class=\"language-text\">cwait</code>으로 인해 블락되어 queue에 들어가면, 이 queue는 보호되는 구역 바깥에 있어서<br>\nC.S를 잠그고 들어가서 멈추는 것이 아니라 바깥으로 나간 상태이므로 다시 C.S는 풀리고, 새로운 프로세스가 들어올 수 있습니다<br>\ncondition 변수의 queue(또는 urgent queue)들은 Mutual Exclusion의 보호 대상이 아니라는 점이 중요했네요</p>\n<h1>Readers-Writers Problem</h1>\n<p>비슷한 것 같지만 또 다른 문제가 있습니다<br>\nfile이나 공유 메모리 공간처럼, C.S 내에 데이터가 주르륵 있고, 이 것을 읽거나 쓰려고 하는데 이번에는</p>\n<ul>\n<li>reader : 데이터를 읽기만 한다</li>\n<li>writer : 데이터를 읽은 뒤, 쓴다</li>\n</ul>\n<p>이 두 종류의 작업자가 있습니다</p>\n<p>이 경우 동시에 여러 reader들이 작업하는 것은 괜찮습니다. 데이터를 수정하지 않고 읽기만 하기 때문이고<br>\n그런데 둘 이상의 writer들은 동시에 작업하면 당연히 안 되겠죠?<br>\nreader와 writer가 동시에 작업하는 것은 어떨까요? 좀 애매해 보이기는 하는데..<br>\n이것도 막도록 합시다. 동시에 작업하면 reader가 읽은 값이 수정 전 값인지 수정 후의 값인지 모를 뿐더러<br>\n더 운이 나쁘면 수정되는 사이에 값을 읽어버릴 수도 있습니다<br>\n아무튼 정리하면 조건은 아래와 같습니다</p>\n<ul>\n<li>reader는 한 번에 둘 이상 동시에 파일을 읽기 가능</li>\n<li>writer는 한 번에 단 하나의 writer만이 파일에 쓰기 가능</li>\n<li>하나의 writer가 파일에 쓰기 작업을 진행중이면, reader는 파일을 읽기 불가</li>\n</ul>\n<p>이렇게 됩니다.<br>\n따라서, 이전에 살펴본 producer-consumer 문제와 달리, 코드가 대칭적으로 생겨먹지 않습니다<br>\n아무튼, 이제 reader와 writer를 위한 <code class=\"language-text\">reader()</code> 함수와 <code class=\"language-text\">writer()</code>함수를 작성할건데<br>\nsemaphore를 이용하여 위 세 가지 조건을 모두 충족시키도록 해봅시다</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/* program readersAndWriters */</span>\n<span class=\"token keyword\">int</span> readcount<span class=\"token punctuation\">;</span>\nsemaphore x<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\nsemaphore wsem<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">reader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>true<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">semWait</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\treadcount<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>readcount <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token function\">semWait</span><span class=\"token punctuation\">(</span>wsem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">semSignal</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">READUNIT</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//대충 read한다는 뜻</span>\n\t\t<span class=\"token function\">semWait</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\treadcount<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>readcount <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token function\">semSignal</span><span class=\"token punctuation\">(</span>wsem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">semSignal</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">writer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>true<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">semWait</span><span class=\"token punctuation\">(</span>wsem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">WRITEUNIT</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//대충 write한다는 뜻</span>\n\t\t<span class=\"token function\">semSignal</span><span class=\"token punctuation\">(</span>wsem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\treadcount <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">parbegin</span><span class=\"token punctuation\">(</span>reader<span class=\"token punctuation\">,</span> writer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">readcount</code>나 <code class=\"language-text\">semaphore x, semaphore wsem</code>같은 각각의 요소들을 한 줄로 정리하기는 좀 애매해서 주석을 많이 달지 않았습니다</p>\n<p>일단 좀 더 짧은 <code class=\"language-text\">writer()</code>부터 살펴보면, 전형적인 C.S 코드인게 보입니다.<br>\nwriter든 reader든, writer와 함께 작업할 수 없으므로 <code class=\"language-text\">wsem</code>이라는 semaphore로 C.S를 잠가놓고 작업합니다.</p>\n<p>그 다음 <code class=\"language-text\">reader()</code>는, 일단 대충 read하는 문장인 <code class=\"language-text\">READUNIT</code>을 중심으로 위쪽과 아래쪽인, 작업 전과 후로 나눠서 살펴봅시다</p>\n<ul>\n<li>작업 전에는, <em>reader</em> 하나 추가요~ <code class=\"language-text\">readcount++</code>. 이 때, <code class=\"language-text\">semaphore x</code>로 C.S를 잠그고 진행</li>\n<li>작업 후에는, <em>reader</em> 하나 나가요~ <code class=\"language-text\">readcount--</code>. 이 때, <code class=\"language-text\">semaphore x</code>로 C.S를 잠그고 진행</li>\n</ul>\n<p>그럼 이제 <code class=\"language-text\">semaphore x</code>와 <code class=\"language-text\">semaphore wsem</code>에 의해 각각 C.S 영역이 생겨서 두 개의 방이 생긴다는 뜻인데<br>\n잠깐 그림으로 살펴보면\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/29fdfe1fcdd06467e881f4d2a7787e5d/5a791/image-12.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 105.0632911392405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAACE0lEQVR42rWVSY/aQBCF509H8ztYLsCFAycQYHvMKYnEdkVIIHFgl9iE2HcwbSr1KpjYzDBBicbSp3a3u59fVVfbLy9fcR2Px2+n0+kHozGGG6WUYVmWQEQfofGc7/v9/vUmaNu2zg/ocrkourt4TFpeRLPZjKbTqYfJZOKsMW+C7CSNEev3ZTuwc7vb7dqLxcJmMbtQKNjFYtFDLpez+DmWG25B/SqozuczAThi57Tb7aQPp/wCOhwOHjhUccga5kNBiM3ncwlxPB5LaHDhvMSNwuDfBDERYr1ej4bDIQ0GA2l5HjkROGDNUw7hCIIQ6/f7NBqN/k8QuVsul7RarYT1eo3n/ybo3hS0DtiYe3jOc4IOjijcOW7dcBSPBblVWOiAMul0OpJPbBLXHOXzeYFrUshmswqpuS/shydls9ncnF5PhoByulaAukb3R5A7IlipVFS9XqdWq0XNZlPaWq1GjUZD7vnUCO12Wxy7TXhCxlnmiqdoNKoSiQSlUilKJpMC7u/78XicSqWSuOa0vBfkpOsIyzAMFQwGye/3E9pAICCgD3Dv8/nwYqpWqyKIvH/oEJugaZqKRCIUCoUIbTgcFtB3xtDGYjGk51PBJApZ1/WDaZrWZ2QyGSudTlvlctnidRYLHa6C2rvv4Xa7VQw9A46he1NYw/R8sTnknzwO4bdn4Ly/sSjQ8bVnjdcv+Z38AvF66imSkSceAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"과정 0\"\n        title=\"\"\n        src=\"/static/29fdfe1fcdd06467e881f4d2a7787e5d/f058b/image-12.png\"\n        srcset=\"/static/29fdfe1fcdd06467e881f4d2a7787e5d/c26ae/image-12.png 158w,\n/static/29fdfe1fcdd06467e881f4d2a7787e5d/6bdcf/image-12.png 315w,\n/static/29fdfe1fcdd06467e881f4d2a7787e5d/f058b/image-12.png 630w,\n/static/29fdfe1fcdd06467e881f4d2a7787e5d/40601/image-12.png 945w,\n/static/29fdfe1fcdd06467e881f4d2a7787e5d/5a791/image-12.png 1248w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n이렇게 시작을 합니다.<br>\n각 semaphore (<code class=\"language-text\">x</code>와 <code class=\"language-text\">wsem</code>)에 의해 제한되는 C.S 영역과 해당 영역이 잠기면 들어가기 위해 대기하는 큐가 존재하고<br>\n<code class=\"language-text\">wsem</code> 내에는 데이터가 읽고 쓰여지는 공간이 존재합니다</p>\n<p>이제 writer인 <code class=\"language-text\">w1, w2, w3</code>가 차례대로 도착했다고 해봅시다.<br>\n그럼 당연히 처음 도착한 <code class=\"language-text\">w1</code>만 <code class=\"language-text\">wsem</code> 내로 들어가 작업을 시작하고, <code class=\"language-text\">w2</code>와 <code class=\"language-text\">w3</code>은 대기하겠죠?\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/730b9c9e695a55da7cd074eab4c1bc45/5a791/image-11.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 105.0632911392405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAACV0lEQVR42rWV+4vaQBDH758u93f4oFxOKP7gT4oxibGUPkBPaTmKCFr8wUcN+EJ8xGh8rbtOZ/aMTfRsj5YLfJndSfazM7OT5ObmNa7tdvtmt9t9Rmkowy/OucEYkwKA56ThM5/W6/XtCSiE0PEGHA4HDmcX+qTFRTCdTmEymQQ0Ho+9NeYJiJFkyMOeLuEJIxeWZQnbtgXCRLFYFKVSKaBCocDwPi03/ED9COT7/R5IFBFGDqvVSs4pUtwANptNQJiqjBAZ5lUgwWazmUxxNBrJ1CgKbxO/ODn/BqQHCdbtdmEwGEC/35cWnwMvA0+05kURUkQEJFiv14PhcPh/QKrdfD4Hx3GkFosF3f83oP9QyHqSdeNCHpAn9L0M6MmDUnTu2oUlylk4p8gxi+tAtJwWeqI26VgdsGc22I4Nhdo3ePjxCF+/oy08QLFUgnw+z6k054199U1ZustTpPZyDrOFDZPpRLbTsQP4MbvfQJxIYLVa5Y1GA9rtNrRaLWnr9To0m0057vzsgNWx5Jjayh9EIGV6l7HjIR6P81QqBaqqQjqdllIzanCO42QyCeVyWUaNZbkEYtF1SsswDB6NRiEcDgPZSDgCkUhEzkk0DoVCtDHUajUJpLo/GyEdgqZpPBaLgaIoQPY+dg9v3ylwF1NOPrKJRILK80dgmhpZ1/WNaZpMKmuy3PscS3/UmfHhaU7+XC7HMpkMq1QqDNcxBG2OQO3ie+i6LkeBXyusLW127qfX0H8oyDADX2xM+Qv6CZwNSIjshQ+Fdc8ilKTT1x4Zt6/yO/kFRRTqn+hdOh8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"과정 1\"\n        title=\"\"\n        src=\"/static/730b9c9e695a55da7cd074eab4c1bc45/f058b/image-11.png\"\n        srcset=\"/static/730b9c9e695a55da7cd074eab4c1bc45/c26ae/image-11.png 158w,\n/static/730b9c9e695a55da7cd074eab4c1bc45/6bdcf/image-11.png 315w,\n/static/730b9c9e695a55da7cd074eab4c1bc45/f058b/image-11.png 630w,\n/static/730b9c9e695a55da7cd074eab4c1bc45/40601/image-11.png 945w,\n/static/730b9c9e695a55da7cd074eab4c1bc45/5a791/image-11.png 1248w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n이렇게, <code class=\"language-text\">wsem</code>은 닫혀있습니다. writer는 대문자 I라서 혼자 작업하고 싶어하네요~</p>\n<p>이제 <code class=\"language-text\">r1</code>이라는 reader가 하나 와서 <code class=\"language-text\">reader()</code>를 실행한다고 해봅시다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/73c44f1121e9e4e9c63ef5372d52a2f2/5a791/image-15.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 105.0632911392405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAACoUlEQVR42rWVa2/aMBSG+6en/o5CNY0iTf3QT0VcEsI07SJBQes0rUIqWlduJd0Ga8slCQlQjMO7c9wEkVLWT7X0yvZJ/PhcYmdn5yXa/f39q/l8/omUI+nrklLqQgglAE8pR+98nE6nuyug7/saPcByuZR41MimelqE4XCIwWAQUb/fD9cYKyB5kmWLeGh+KPLcN03TtyzLJ5hfLpf9SqUSUalUEvScl+vrQC0AysViARZ7RJ5jMpmoOY9nsxkoNNWHornykBjGViDDRqMRBhTibX+A4ciC4zgKyo37UJJffg7oB/n68/safy9PYNaraLU7sG1bgSkVCCPhNVuBvBvvyoWwLJuAv9Crn+K6WcNV5xpjgnmeh7u7OwY9DyQPpBMscl0XNo0ddwJn/DBnAG/G3rOXHO2TQDIqYL1el61WCzc3NyrhvFjKRSCptKQ0clUZjqXK5/Mhs8IcBYnHnEJ0px682QSNyx8YkZfj8VhFtRVIYUjOTSgOq2N2YFGVLcdCsfYVldoX/Pxm4PtpESflCorFouRiPf6wt54U13NXnlqujdHYgmffUmFu0e310O12ZfCFbObw/PxcNhoNtNttcC65v7i4QLPZVGPzqgOzY9IndKUKs+5EJGQ+y3wCDg8PZSqVQiaTQTqdVspkM9E5jY+Pj3F2dqa85jRtACnpGoel67rc399HLBYD9/FYHPF4XM1ZPN7b2+ONUavVFJBAT3vIRcjlcjKZTCKRSID7g+QBXr9N4E0ysbJxf3R0xOn5LzDNl4CmaTPDMIRS3hCFdwWR/qAJ/f3DnO2FQkFks1lRrVYFrRMEmgXA3MZ9SCdE8ilZ14Ryy5s9thMgUhRiGJEbm0L+THYG5yPy/fyGjUR5zxOUpfFtT4zdF/md/AODO+dyY+frvgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"과정 2\"\n        title=\"\"\n        src=\"/static/73c44f1121e9e4e9c63ef5372d52a2f2/f058b/image-15.png\"\n        srcset=\"/static/73c44f1121e9e4e9c63ef5372d52a2f2/c26ae/image-15.png 158w,\n/static/73c44f1121e9e4e9c63ef5372d52a2f2/6bdcf/image-15.png 315w,\n/static/73c44f1121e9e4e9c63ef5372d52a2f2/f058b/image-15.png 630w,\n/static/73c44f1121e9e4e9c63ef5372d52a2f2/40601/image-15.png 945w,\n/static/73c44f1121e9e4e9c63ef5372d52a2f2/5a791/image-15.png 1248w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n이해를 돕기 위해 <code class=\"language-text\">readcount</code> 변수를 값과 함께 띄웠습니다<br>\n<code class=\"language-text\">r1</code>은 <code class=\"language-text\">x</code>를 잠그고 들어가서는 <code class=\"language-text\">readcount++</code>을 진행했고,<br>\n그런데 그러고 나니 <code class=\"language-text\">readcount==1</code>이므로,<br>\n<code class=\"language-text\">r1</code>은 <code class=\"language-text\">wsem</code>에 가서 <strong>줄을 섭니다. <code class=\"language-text\">x</code>를 잠근 상태 그대로.</strong></p>\n<p>그럼 이제 다른 reader 친구들, <code class=\"language-text\">r2</code>, <code class=\"language-text\">r3</code>, <code class=\"language-text\">r4</code>, <code class=\"language-text\">r5</code>가 주르륵.. 들어오면 어떻게 될까요?\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2dfe029415edbfa7b14bd68daf0dad46/5a791/image-16.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 105.0632911392405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAACvElEQVR42rWVa08aQRSG/dONv0MwTZGk8YNNGw2XXZam6S3UGmyaEhJJrdxktWIVZC8st11meHvOLFAQqZ/c5M3MHGaeOZeZYWPjKb7RaPTM9/2PpDRJX5QQQg+CgCR0CehiQQiVpjkfBoPB5hwopdToB0wmE4F7H9nCVgqMnCsM7ctQziXsTgvtdnu2xpgDyZMUW4LwkzOR59I0TWlZtnSslqzk38h6/pVSLf9aFo4/y9yXw8C2bV6uLwK1KVCMx2OwKAyQ5+j3+2rMfX80+Cd/iOFQSXlIDGMtkGGWZeGu08Ft+w4dy4brumSXKgVCsqTaRPDkx4CS5nQIdvX7An/ODmGWi6jVG3AcR4EpFZhFwmvWAnk33pW9sG2HgJe4Lh/jolrCeeMCXYL1ej20Wi0GPQ4kD4Q7XeR5Hhzqu14fbjccM4A3Y+/ZS472QSAZFbBcLotarYabmxuVcJUvMZ5KKE3oMHJVGQ46URTR4yGzZjmaJh4+hegNeugN+6ic/YRFXna7XRXVWiCFITg3M3FYDbMBm6psuzZypW84KuXx67uBH8c5HH49Qi6XE1ys+wd77U3xet7cU9tzYHVt9JxbKswtmtfXaDabYnpCVnN4cnIiKpUK6vU6OJfcnp6eolqtqr553oDZMOkInavCLDqxFDLfZbrc2N3dFQcHB0gmk0gkEkrJVHJ5TP39/X0UCgXlNadpBUhJ1zgsXdfF9vY2IpEIuI1GoohGo2rM4v7W1hZvjFKpFF5H33/YQy5COp0W8XgcsVgM3O7Ed/D8ZQwv4rG5jdu9vT1Oz3+BCX4ENE0bGoYRKGWMIPs2GyTea4H+LhyzPZvNBqlUKigWiwGtC3x+JUJgeuU9pBsi+JYsqk+55c3u2wmwVBRiGEsvNoX8iewMzixJysyKjUR5zxCUpfFrT4zNJ/k7+QvhzeeDDi99RQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"과정 3\"\n        title=\"\"\n        src=\"/static/2dfe029415edbfa7b14bd68daf0dad46/f058b/image-16.png\"\n        srcset=\"/static/2dfe029415edbfa7b14bd68daf0dad46/c26ae/image-16.png 158w,\n/static/2dfe029415edbfa7b14bd68daf0dad46/6bdcf/image-16.png 315w,\n/static/2dfe029415edbfa7b14bd68daf0dad46/f058b/image-16.png 630w,\n/static/2dfe029415edbfa7b14bd68daf0dad46/40601/image-16.png 945w,\n/static/2dfe029415edbfa7b14bd68daf0dad46/5a791/image-16.png 1248w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<code class=\"language-text\">readcount</code>를 ++하려고 호기롭게 들어왔지만,<br>\n우리 reader 친구들은 <code class=\"language-text\">x</code>가 닫혀있어서 하는 수 없이 줄을 서게 됩니다..<br>\n즉 writer가 <code class=\"language-text\">wsem</code>을 잠그고 들어가 작업중인 경우, <strong>reader들은 단 하나만 <code class=\"language-text\">wsem</code>에 가서 대표로 줄을 서고, 나머지는 <code class=\"language-text\">x</code>에서 기다립니다.</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 210px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/423ef583b90ea1d5f78cc3a5ba5d72c5/65ed1/image-17.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAADSUlEQVR42o1TWU8TYRTt/3EJkaAoLQpSSjvThZZOC23ZWkophmpkU3ADN0pMjJrgCxKqiUAwERMTAYEHIPhA4hKBlp02QkuAFugyhS4eOlDqg9H7MDnfnXvuPffMN6xIJBIIBHZ3d4PBoNvtBvb7/QD7+/s0TW9vb/t8Pq/XC7y1tYV8NBoFRmZvb481Pz8/NDQ0PDxstVpbWlrex6KtrW1zc7Ozs7Ojo2NsbKyvr298fNxisfT29i4uLk5OToIyPT3NWl9fHxgYGB0d3djY6OrqmpiYQBZFOzs7/f39ADMzM2CCgOPIyMjy8jJzhEBWXAZkLy0tAWCRhYUFp9MZDochG/qhEPnV1VUMQD1WQzEAKxKL6FGgDqPAdDgcc3NzkaOIFyRmWIlZPFdWVrAIk7Hb7Wtra4kEpibe65jMZGFbvAgqmGP0L8FKHIvFYGbiVnABtidO+yvZGQsAGAN7ADweD8z7XzJugsvlam9v7+npQQaG22w2GP5v2aDhDmGs2WzGB2dewXOsE46E4y1CodAfbofDIWYyY+/g4CBuFfMKHfHZGBVe747b4wE4JkeiETQGWI9FzDA/PMMEYFw164z1y7cv9U21dQ8MYr3kda+FEctieswtzFrevf3w6aPVOo0jfgaHw84wez52l98s4VUQbAlHcVVE6LLVJtFP29Th5ABN322t5kpTSR2PUIvvtTYOfn7v3tx+0/2GpxEliVIMt+QqvbCgVkbohWU1cnUF9/GLp4fkNddqUX1e07NiU0MBR8HlUByeOrPJXMNVcE9kJQuKidLm/ObnxVduKM9TGVklguySzCcvm7HtAXlqdiqd4giMJGkkc00EVUnydYTKkFNoFGvr5GUPldySzEuaixzqgro+V1cjy1BeqrpdEQ7tH5C//vh+UnC21qzS1ktTxOeyC9icvPTTWWnGRukrSzllIE7xzmivClRVfNmVnIZHmjQpW1ik2KODB+RfTruiSqi5KSu9Lj0jTucbBAK9IFdL5lUQcp1EVUaoqmWFN6SVDcokki0yCfna7OLrpTQdOCD7fb5SU2GyLI3U8PTXhJV3qAskJ0d5udAg5ufzjffzSQ03lcqgyiVak8R0T8kWsuXaAjpI/wYY950fF6xXDAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"내 짬에 해야겠냐?\"\n        title=\"\"\n        src=\"/static/423ef583b90ea1d5f78cc3a5ba5d72c5/65ed1/image-17.png\"\n        srcset=\"/static/423ef583b90ea1d5f78cc3a5ba5d72c5/c26ae/image-17.png 158w,\n/static/423ef583b90ea1d5f78cc3a5ba5d72c5/65ed1/image-17.png 210w\"\n        sizes=\"(max-width: 210px) 100vw, 210px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n막내가 아닌 짬킹이 줄을 서는 선진병영이네요</p>\n<p>이제 <code class=\"language-text\">w1</code>이 끝났다고 해봅시다.<br>\n그리고, 이 semaphore는 강한 semaphore라서 큐에서 꺼내오는 순서는 곧 죽어도 FIFO라고 가정하면<br>\n<code class=\"language-text\">w2</code>가 들어가서 작업, .. 끝나면 <code class=\"language-text\">w3</code>가 들어가서 작업, .. 끝나면 <code class=\"language-text\">r1</code>이 들어가니까...?\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/03afc902aa9ff81475c4af7c1eb3decf/5a791/image-19.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 105.0632911392405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAACjklEQVR42rWV22saQRTG80+X/A19afECjW4f8mBIMV11NwqFXvACtrSINIJgV43VqPF+qdd1xq/njBpMrIl9yMKPHWfnfPOdMxePjp7jmc1mL+bz+SciRJjbCCFM27YJYUrAFFtgRYjGfJxMJsd3glJKgz5guVwKPHiob/WWArP+Daa98op+Gb1OE61WaxMTvhMkJ0HusVeP3EDOZalUkt1uT/a7Tfkr+U4WkmeKfPJcpr5+kdFY3O71ehxubgsaa0GxWCzAUBog5xiPx+o3O53PJmumiulUoRySRnivIIt1u120Ox00mi202x2wi8VC0LclBE3E8ISCBz8lKKleHRK7qVRQt36gWsqhVm9wEDYZbOCYvYI8G8/K6bGjSqWMQiaJ6m+LBG//X7Df74vBYIDRaKRoNpuo1uoY/hmB+yn4MEHqVIK5XE7k83nc3q7ccB1pf0EuVa2U84dIrs8hKbNgu91WbRZjd+zyIZzVXkHad2KT1nA4VAtTLpdVPbkdi8UQj8cViURCEY1GBYnubOydk8KD2BnXcrXyUjmmk6FoNBqo1WqoVqtivUN2a3h19VNYVh65bAbfvyVxfX2NbDYLy7JQKBRAp0ZRLBaV420T91Lms8zFPz09FRcX7/Hh/DWMMzf0oIlAQCcC0HVdwW2/349UKqVcc5l2BCk1g9MyTVO43G68cbzEiesVnC43XC4XnE6ngtsOh4MnRiaTUYIk9G+HvBihUEhomhcnHg1e7S28Xg/hhcfjUWiapt4+n4/Kc/WooM6XgGEY03A4bD9GJBKxg8GgnU6nbYqzSWi6Fgzt3Ie0omJzSp6C9+n2opBG+N6NTSl/pn4WvjwEqvsliTIG3/akcfwsfyd/ATGO5xAktasEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"과정 4\"\n        title=\"\"\n        src=\"/static/03afc902aa9ff81475c4af7c1eb3decf/f058b/image-19.png\"\n        srcset=\"/static/03afc902aa9ff81475c4af7c1eb3decf/c26ae/image-19.png 158w,\n/static/03afc902aa9ff81475c4af7c1eb3decf/6bdcf/image-19.png 315w,\n/static/03afc902aa9ff81475c4af7c1eb3decf/f058b/image-19.png 630w,\n/static/03afc902aa9ff81475c4af7c1eb3decf/40601/image-19.png 945w,\n/static/03afc902aa9ff81475c4af7c1eb3decf/5a791/image-19.png 1248w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n<code class=\"language-text\">r1</code>의 <code class=\"language-text\">semWait(wsem)</code>이 풀린 것이고, <code class=\"language-text\">semSignal(x)</code>로 <code class=\"language-text\">x</code>의 잠금을 풀었습니다.<br>\n이제 <code class=\"language-text\">READUNIT()</code>에서 읽기 작업 중인데, 오래 걸리는 작업이라 여기서 한동안 머무른다고 생각해봅시다.</p>\n<p>이 때 <code class=\"language-text\">x</code>은 값이 1로 열려 있고, <code class=\"language-text\">wsem</code>은 <code class=\"language-text\">r1</code>이 0인 채로 지나왔습니다<br>\n이 경우 writer는 <code class=\"language-text\">semWait(wsem)</code>을 먼저 실행하기 때문에 값이 -1이 되어 기다리게 되지만,<br>\nreader는 <code class=\"language-text\">x</code>를 잠근다 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\rightarrow</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span></span> <code class=\"language-text\">readcount++</code> <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\rightarrow</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span></span> <code class=\"language-text\">readcount</code>가 1보다 큰, 2 이상이다 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\rightarrow</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span></span> <code class=\"language-text\">x</code>의 잠금을 푼다<br>\n이 과정을 반복하며 <code class=\"language-text\">READUNIT()</code>에 얼마든지 도달할 수 있습니다<br>\n그럼 이 이후로 <code class=\"language-text\">r2, r3, r4, r5</code>가 모두 <code class=\"language-text\">READUNIT()</code>에 도달하고, 새로운 writer인 <code class=\"language-text\">w4</code>가 들어왔다고 해봅시다\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/885c2a1b28ea282cd4cf17898e284807/5a791/image-20.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 105.0632911392405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAACz0lEQVR42rWVaU9TQRSG+dOGH6AS4YNJKzFdMKlS/QBiF1ojLqSl1Fa0QYpoV7vQhdLSja6XGV7PmdLSWpF+4SZvJpk755lz3jl37tzcXTy9Xu9ev9//SLKTnOMSQjg1TVOSwEiChIHstOZDp9OZHwGllA56gcvLS4G/HpobjFKg2yxdq1FErVpBuVwexrhGQMrExjPa4JFDUeYynU7Laq0uG7WKPAo45ZF/Q4Z3XstI0CFDwR3p8e5otVqNw53jQMcVUFxcXIBFZYAyR7vdUVnm8wUcHHxHPBZFnQD9fg/dbhdUqsqQGK4bgQyrVqs4OzvDyUkRgUAQ29vbKBSLahNJGwgeSYIX3waUtKZCsHzuGLlffrx6YUYme6wA/J7WYVgJx9wI5N04iEtkXwqFPL7tvkMuk0SpdArydASaCViv10Wz2USr1QKPjUYTXp8f8XiCvGxz0GxAmlTAaDQqEokEiuRVq3WuvIxEIkinUyprtoLHcVFFt5c8FGeayWSQSqVUua1um7JuTIiruhFIQYIN59I4u0qlglAohFg0iuNCDrs/9vB5LwCvxwufz6fk8XgEQacae+JLoWJU6zeb56r/yqdl1ULV8zrKlTJ/HXRIJTq0Ar3Pi6sOmfYwHA6LaCyG1O84EtEjfA364fd58CXgx15gF/HIT2SzWSSTSbXBeBITJfO3TB0Pi8Ui1tfXsbW2jPcvF+BeXcKW9SHePn8Al+U+nKuPYbe9wdramrKCfWabpoDkl4NbwOl0iifLy3iqW4RR/wgG/SJM+gUYdQtqNOiXoNPpeGMcHh4qIIH+nSEfht1uF2azCQajGaaVZzCaVmBQMiuZzDRnNMJqtbI9/wVucOM6HI6uy+XSBtoc0/Wc2+3WbDabtr+/r1GcRqDuFdA+dR9S3wnuvVnErTV+KMRwTdzYVPInmmfw5iwi3zcJynLwbU+M+Tv5nfwBmM/frynqjeQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"과정 5\"\n        title=\"\"\n        src=\"/static/885c2a1b28ea282cd4cf17898e284807/f058b/image-20.png\"\n        srcset=\"/static/885c2a1b28ea282cd4cf17898e284807/c26ae/image-20.png 158w,\n/static/885c2a1b28ea282cd4cf17898e284807/6bdcf/image-20.png 315w,\n/static/885c2a1b28ea282cd4cf17898e284807/f058b/image-20.png 630w,\n/static/885c2a1b28ea282cd4cf17898e284807/40601/image-20.png 945w,\n/static/885c2a1b28ea282cd4cf17898e284807/5a791/image-20.png 1248w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\nreader들은 너무 외향적이라 다같이 파티를 해버리네요<br>\nwriter인 <code class=\"language-text\">w4</code>는 너무 내향적이라 파티에 끼지 못하고 그냥 밖에서 기다립니다..</p>\n<p>게다가 여기서 새 reader인 <code class=\"language-text\">r6</code>가 들어와도,<br>\n밖에서 기다리는 <code class=\"language-text\">w4</code>는 신경도 쓰지 않고 그냥 <code class=\"language-text\">READUNIT()</code>하러 들어가버릴 수 있습니다\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4fc6b4b2120d3bebbed2789570d87172/5a791/image-24.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 105.0632911392405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAACuElEQVR42rWV608aQRTF+083fm7SppqmSa2mCqgxjdpE0wILJm2tCQhtbOOjSq1AaFkV5LEsu7wWXWb29N4FLEqJ9oOTnMzsLPc3596ZWR48uI92cXHx8PLy8hMpQFIGJYRQbNt2JQEFwwrQbzYsyxq7Akopg/QCjuMI3Gg01+2lQLtWhKFrqFR06JUK9RVomtaPCV8ByYmfZ+xuk32Rc6mqqjQMU5pVTR59UeTe9pbcin2W8XjcVTQatQ3D4HBlEBjsAUWn0wGL0gA5R8uy3LGu67CsFmgRtNvtK1GqrkNihEcCGVCtVl1IsVhAMplCoVCAoAXkDQn+8W1A2XOUy50ifxzH0cE3lMqa666fQV8cMxLIq/GqvBGGaRLwDLnMd5z8TpPDIgf9H9A0TVGv19FsNlGv1VCjsW7UoKonaDTqHHw3IE26wFQqJTKZDM7Pz8Fgduo4EjWC8zO3fgZ90fPtKfeK7TrgcYeclbUymlbThQ+KsxoJpKILTotrxT1vQjab5SCc5XPY3NnC9u5XRCNRxGIxV5FIRPD7mwf72k1xeuLWaDTJKbklx2r+FOXu7UCpVHJLk8/nRe+EDNfw8PBQpNJpZH+RMknqU0j+/IFMOomTbAaJgz2kjhPIqqp77QZNXEuZ7zKdeCwuLoq1tTV8WJ3Gxso43i8/x+abCRpP4OPKM4ReP4Wy8AjvVpexs7vn1pfLNASkDQjyBiiKIqamp/FqcgKel+OYmRyHZ/IJZl905Z3i58e08AISiYQLJNC/HfImBAIB4fN5MevxwTs3D493jjSPWa+PRGPfPGbo3dLSEpeHgM5I4NtWq4VgMNgOh8N2V6EB/Z1bXw/bfr/f3t/ftynOJlC7BwwMfQ/phgi+JXcRH63BTSFG+NoXm1LepHkGh+4iqnuIoKwgf+2JMXYvfyd/ALMe5Zj7vEIvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"과정 6\"\n        title=\"\"\n        src=\"/static/4fc6b4b2120d3bebbed2789570d87172/f058b/image-24.png\"\n        srcset=\"/static/4fc6b4b2120d3bebbed2789570d87172/c26ae/image-24.png 158w,\n/static/4fc6b4b2120d3bebbed2789570d87172/6bdcf/image-24.png 315w,\n/static/4fc6b4b2120d3bebbed2789570d87172/f058b/image-24.png 630w,\n/static/4fc6b4b2120d3bebbed2789570d87172/40601/image-24.png 945w,\n/static/4fc6b4b2120d3bebbed2789570d87172/5a791/image-24.png 1248w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n이러한 특성때문에, <strong>reader들이 우선순위를 가진다</strong>고 말합니다.</p>\n<p>그렇게 reader들의 왁자지껄 웅성웅성 👥👤👥👥👤 파티가 끝나고\n모든 reader들이 나가서 <code class=\"language-text\">readcount=0</code>이 되고 나면, 마지막에 나가는 reader가 <code class=\"language-text\">semSignal(wsem)</code>으로 이제 <code class=\"language-text\">wsem</code>에 아무도 없음을 알립니다.</p>\n<p><a href=\"https://www.youtube.com/watch?v=KNp2VyF0qHY\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.69620253164557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACYElEQVR42jWRW08TQRiG92foDSSGQ9jtHma7ZWl3trO7M9um3QIKRkqLtBQsQhHSpsGCCEhEEBJJxYD1QAFjQNRIOHhlTUy4knhhvPXGf+K0SvJkkpnkeb+Zd5hI30i4qw9DXZOBDbWoEx7s7nw0frsLGxqECiFuy5AsDCwiGBaPMEWyCN2Kls10xkeC4ashQgj0RcOhqeHUSnb09PmTfKIHtyoqthRiy8SmvmBUfdHEAFdPALGZSG8aG1j3KL1hsrM8vzE3ffaufP5+Z72QTTrYA72yHQSYQgDGF9g1Akz7jYQFfXJz8/zY0K/Tgz+Vk/OPbyrbG7+PDsozk4IkuIPBf6Nq06hpXUQQJoZs5FGE5qZcKv7tben7u/LR2vJWfuLry+L63QmeYxXbprel75RxABCrJlsXMjSgDGSupcexP22ufi6tVUpPj5cW9h7Pjse6gYujnbn8iFKLqDrSf9lmujWtledUSVBFdimXPny2crb/+sur4u7SNHLzPiCq2GR1xPt1HumCYYomqbaNqysTaVNBY4PCsproykSdueH4cia1OJwIwdaGuvqAT9VMg61NboF+ESEeGbRwGkFh/JLQcPkSW19vyOL90b6FsYFCoiOfdPimK4BrMhUPsXRO9/GmBkO6C+oy1kXDpJ8vE8wgoATNoAe4HU1ZzKZWJ+/MF5zZKY1trMtmvekB78yU9vDBUDIZzUz4oikUG/TeTLdlJzXUYTLH2yc/Kj+LxRf5zNDmXG5rsbA63X8vF3az3EBSil1v6+lQT3dLh+X9wkxk/8NevnCrfyR+LW5p7YG/HxLWXkknHdkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"잘 놀다 갑니다\"\n        title=\"\"\n        src=\"/static/ce4188060316f1eb94aab3616d62e9f3/5a46d/image-27.png\"\n        srcset=\"/static/ce4188060316f1eb94aab3616d62e9f3/c26ae/image-27.png 158w,\n/static/ce4188060316f1eb94aab3616d62e9f3/5a46d/image-27.png 300w\"\n        sizes=\"(max-width: 300px) 100vw, 300px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></a></p>\n<p>그러고 나면, 이제 조용해진 <code class=\"language-text\">wsem</code>에 드디어 <code class=\"language-text\">w4</code>가 들어갑니다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d742d223b9694fca8a6464eadd03d0e7/5a791/image-25.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 105.0632911392405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsTAAALEwEAmpwYAAACcklEQVR42rWVW4vaUBDH90uX/Q62ffBCQbcPPoigoiYxtpS2oCi0pYhFQVC0Kt6w3jXejidOZ2YTa+ra3T7sgT+TTHJ+Z2bOnOTm5jnGbrd7sd/vP6EUlHYuKaUmhGABwENS8J2Pm83m9gQ0TVPFB3A8HiX8NdDHFifBZDKB8Xjs0Gg0sufoJyBGkiSPuB+mLYzcbLVa5mw2MxFm5nI5M5/PO5TNZgU+p+naOVC1gPJwOACJIsLIYb1e8z1FigvAdrt1CFPlCJGhXwUSbDqdcorD4ZBToyjsRc4lyfkYkF4kWKfTgX6/D71ejy2+B3YGtmjOVSCtRjBKjyIiIMG63S4MBoP/B87nc7lcLsEwDCC7WCxOonuc/DQgOhlYrVZlvV7n9AhAw64p10/eR38uzOjxlK1ig11PuqbojM0aFsuFI3LK6ioQ20LSRKoVWWqTZrMJs+kMpvMZ5H98hS/fv0E2kwXsSVYmk5EIvWjsqydltVpxhNSP/V8D3n08HdxOVgdIq0Mua1gqlWStVoNGowFUS7KVSoWvi8Ui37fbbWj8bDD4PAhHynSWseMhGAzKWCwGiUQC4vE4K5lMQiQSgXA4zH5SNBqFQqHA9aUyXQAxJZU2QNM06fP5wOPxAFuvB7xeL7hcLnC73ewjiwtDuVxmIIIejpA2QVEUeXd3B36/H8iS3G+88PL1K3iL14FAgJ+FQiEqzz+BcSq6qqpbXdcFK6WL9Lu0iH1QhPJeE2nLn06nBZZBYE0FzhMI2lpA5eJ7iCdE0in5ozUYuBAt5vQb3Frnm4IM3fHFxpQ/o5/AqacI655CKEmlrz0ybp/ld/IbOtfoXHEZF10AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"과정 7\"\n        title=\"\"\n        src=\"/static/d742d223b9694fca8a6464eadd03d0e7/f058b/image-25.png\"\n        srcset=\"/static/d742d223b9694fca8a6464eadd03d0e7/c26ae/image-25.png 158w,\n/static/d742d223b9694fca8a6464eadd03d0e7/6bdcf/image-25.png 315w,\n/static/d742d223b9694fca8a6464eadd03d0e7/f058b/image-25.png 630w,\n/static/d742d223b9694fca8a6464eadd03d0e7/40601/image-25.png 945w,\n/static/d742d223b9694fca8a6464eadd03d0e7/5a791/image-25.png 1248w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n아 시끄러운 <code class=\"language-text\">wsem</code>에 차마 들어가지 못하고 밖에서 기다린 <code class=\"language-text\">w4</code>에 과몰입했는지 이 그림조차 너무 고요하게 느껴집니다...</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 225px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3d9be0d015ab779259049099e2022f2c/3684f/image-28.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEu0lEQVR42hXR/U8aBwDG8UuWJXtJnZhWa31FlPfj9TgOuDuOO14OFAuKIohYLEIFUYH6jm+IttpofZkvVVc3qtjaTmvrXrQvWbZuXZp27bKsS7Yflu2X/Ruzf8An+T55gDubK36Pm6boSpqenxrez2zOT09dah9o9nU2e0NNnkseb5u13u/2RV2+qLc1Fo9EguFed0u0wRsGdtNrLW5XpcmKo8aJoeGv7m1vbdy46O8oLRHl5lXU6cw/7j2cufapjrDipI0yObrCIZvNo6Vq9GQNsLe94a2rM5FmHWYa6+97/ODLO5trlI42oGQ1Rf+8vvTbbubF0aPmCyGUrDHS9ZG2oKPORxqdVRbPOxzweilcr1YSo919j+/fzqytjPfEI/XWSkydSSWfLy0cTF1zOxrKeCpCa+0IBij9eRYfwbTVwGHm88vtbQROIUoiEYs/ub+zvbY02R/zWfV2kliKhV4uz+6PppLxPi6IUaQtEgzoDOfZEgLFzwPf3r7V3xkiNASOWq4MDX/3cPf+1k1njdNvM690en9dHX+zfOXOQN9gtJsvxbSEpSPQqiOtFSD+Dh/fzSRiEUgsVcg1sxOp1z88Odo7tlc2nDmVc9GszyTan17rmwgE2AKEyUNIyhoNB83mumKOQoNVA8+PD0cud5Eoiig0c9Nz68vp2poWuURz9gzvvfezcrILOKXlvfGeickFlyfiD3TFwkFPU8hS2+poCAH//ftnsjdOEzpKa6hztiogmMvliSRiRFGbfxb8JDu3sIBfaaZHE4m5uRukyeb3NoQ6uz2Xel2+LuDtq582FmaqSArTqBRKoxrTaTRKsZSvJ50WKp7DOJfDKLOY3NV293ByOpma2biZWVnfWVxOuxoDwIPdndXZKYueJHAEUaMQQmK4UoPDGGby1c/X0t2gwIBq3UKZ8eQbm817wZ/o7F/1h1NFOUXAs+OjxekUoUG0uBrFEJFEiuEqDEc0KGqn+8Oe6zqNnSfE2TxMobRwRahASmiNjYTBU5BbAqR6hmZTIypYqlRBCoVYIBTIYTmigrTYST0G80E5n8s4VcRkqrgyAjFXY/oqoVSnQKpAIQqgPHmrp0mPo2IxKBQLRGCFQQfX2SkLoZSxS2mN2KiWSvmgEiZomp4MRrtaWmRKgxw2VLAFAOsM62STSiGBZGJEjbT5rL98ffX379e31v3XZ2x3t8ce7CwebM3vZ2b+er338mi2ubEagswgKCsuOQcwyyBYLJOCXFghUauhYBP95njpjxd7h/tX0+nora3k7s780eHmwd7GP38/e/viltflksjo/PwCBiMLkJSKRFyuRMiWiDhSkNPaaNleHU+vTTw9Afd65ues6S+aDg+Gtj+befLN5qtHy26Hg1kuYpYyxaAMYH3AkJSzYRkoZJfxuExcLWpvtgy2OwY67CNdztnh6EIyvjjePzUYnRy4OBpzykWC/HOFIiEECiEg+0OGuJxlILSwHGaVFOedzmaVFnDYpUXFZ0sKhZVoj9M0ZicHSSjCZUFlLGZeXjGDkV9QWPHRx6eBrKxsmx7tDPgRJS4SgjIpT4vDJKWGFSCnXGJQhT2VYy56pBpNqGRGoZhTXiGgTTVqjQlC9P8DrUiigscZnqsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"혼자가 좋아\"\n        title=\"\"\n        src=\"/static/3d9be0d015ab779259049099e2022f2c/3684f/image-28.png\"\n        srcset=\"/static/3d9be0d015ab779259049099e2022f2c/c26ae/image-28.png 158w,\n/static/3d9be0d015ab779259049099e2022f2c/3684f/image-28.png 225w\"\n        sizes=\"(max-width: 225px) 100vw, 225px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>아무튼, 그래서 정리하자면</p>\n<p><code class=\"language-text\">readcount</code>는</p>\n<ul>\n<li>reader가 작업 중이면 읽기 작업을 진행 중인 reader의 수</li>\n<li>writer가 작업 중이면 기다리는 reader의 수 (하나는 <code class=\"language-text\">wsem</code>에 대표로 줄 서고, 나머지는 <code class=\"language-text\">x</code>에서 줄 선다)</li>\n</ul>\n<p>그리고 또 <code class=\"language-text\">semaphore x</code>의 역할은</p>\n<ul>\n<li><code class=\"language-text\">readcount</code>의 조정을 한 번에 한 프로세스만 하게 하기 위함</li>\n<li>reader들이 C.S에 들어가고자 하는데 이미 writer가 작업중이라 들어가지 못할 때, 짬킹을 제외한 나머지를 줄세우는 역할</li>\n</ul>\n<p>마지막으로 <code class=\"language-text\">semaphore wsem</code>은</p>\n<ul>\n<li>writer가 작업중이면, <code class=\"language-text\">wsem</code>을 아예 잠그고 들어간다</li>\n<li>reader가 들어가 있으면, <code class=\"language-text\">wsem</code>은 reader에게만 열려있다</li>\n</ul>\n<p>이렇게 됩니다</p>\n<hr>\n<p>휴.. 생각보다 글이 길어져서 햄드네요<br>\n사실 내일 운영체제 중간고사입니다<br>\n아좌좍~\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 347px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b268d0733d1cccb1892d7c687c8d8828/39e45/image-31.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.77215189873418%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABVUlEQVR42k2RW6uCUBCF9/9/r7fOs8ixlKQL3UAqsgcrLBTsTkVEUZkS3bTv6MsZcDPutdbMmtnC87w4joMguFwur9drt9utVqvJZHK9Xn3fB1osFsvl8na7zefzzWazXq/hoLrf78J1XRiHw+F8PoONx2OUtm2Tn06n/2IElmUBwRmNRp/PR0ynU3j1er3VasGjOSUfjwe1aJ6K8UIOLQxDPwk4QAKs2Ww2Go1SqWSaZuq22+0C00FRlOFwiJihOKMoipN4Pp/QxGw26/V6+XxeVVX6Y4SRJEkCy2QyxWKxVqtxgxjzJLIs0+x4POJO7Pf7fr+fXmmaZhhGoVBA/JNEuVzOZrNYgEY5x3FyuRwDUujPNh8LhISYnfObesPCbxI4x1Sn06Hb+/1ut9u6rrO8wWAgWBpXCEjQUJ5ts9VqtYqA56HbdrvlZGE8SqVSwSCQbdtfFw+aU2p6qX8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"자퇴서\"\n        title=\"\"\n        src=\"/static/b268d0733d1cccb1892d7c687c8d8828/39e45/image-31.png\"\n        srcset=\"/static/b268d0733d1cccb1892d7c687c8d8828/c26ae/image-31.png 158w,\n/static/b268d0733d1cccb1892d7c687c8d8828/6bdcf/image-31.png 315w,\n/static/b268d0733d1cccb1892d7c687c8d8828/39e45/image-31.png 347w\"\n        sizes=\"(max-width: 347px) 100vw, 347px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>이만 마칩니다.</p>","frontmatter":{"title":"✍️ Producer-Consumer Problem 그리고 Readers-Writers Problem","date":"April 23, 2024","description":"Semaphore와 Monitor로 해결해봅시다","tag":["OS"]},"tableOfContents":"<ul>\n<li>\n<p><a href=\"#producer-consumer-problem\">Producer-Consumer Problem</a></p>\n<ul>\n<li><a href=\"#semaphore%EB%A1%9C-producer-consumer-problem-%ED%95%B4%EA%B2%B0%ED%95%98%EA%B8%B0\">Semaphore로 Producer-Consumer Problem 해결하기</a></li>\n<li><a href=\"#monitor%EB%A1%9C-producer-consumer-problem-%ED%95%B4%EA%B2%B0%ED%95%98%EA%B8%B0\">Monitor로 Producer-Consumer Problem 해결하기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#readers-writers-problem\">Readers-Writers Problem</a></p>\n</li>\n</ul>"},"previous":{"fields":{"slug":"/mutual-exclusion-by-os/"},"frontmatter":{"title":" 🕹️ OS 툴로 Critical Section 통제하기 : Mutual Exclusion By Semaphore & Monitor"}},"next":{"fields":{"slug":"/linear-fit-by-python-scipy/"},"frontmatter":{"title":"🪢 scipy의 curve_fit 적당히 써보기"}}},"pageContext":{"id":"1f1f03e1-5579-5c2d-a96e-73e26107fd60","previousPostId":"4731dcc2-6182-51ca-9f5c-da0807f06419","nextPostId":"84f52241-7bfc-5d32-9496-0e06d1d776bc"}},"staticQueryHashes":["2841359383"],"slicesMap":{}}