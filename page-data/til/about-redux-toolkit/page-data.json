{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/til/about-redux-toolkit/","result":{"data":{"site":{"siteMetadata":{"title":"조성개발실록"}},"markdownRemark":{"id":"9de55127-7456-5f3a-b8e1-2dd8ff6d2ca9","excerpt":"! 주의 : TIL 게시글입니다. 다듬지 않고 올리거나 기록을 통째로 복붙했을 수 있는 뒷고기 포스팅입니다.  지난 시간에는 리덕수 그잡채에 대해 알아봤는디라 기억할런가 몰것네잉 이전에 살펴본 Redux…","html":"<blockquote>\n<p>! 주의 : TIL 게시글입니다. 다듬지 않고 올리거나 기록을 통째로 복붙했을 수 있는 뒷고기 포스팅입니다.</p>\n</blockquote>\n<figure>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 360px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/42cd408979776e21fe2c3a86858b9d95/f21e7/image.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.151898734177216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqElEQVR42j2OsQqDMBiEfZKY36AJmoA1AZPg5iIuzpXSpVDoVujmUOib92qoN4Qvdxz/ZTnnlaw4596HZVmmaVrXNYTAGMv/Qnpw8uEQUUZFsb2e18vZOYvmOI7zPKNc17VSqmmaA7TWYLxgIcSvLETxeW+P+w1BjNF73/e9c24YBnxPu1CAY61t2xbQdV1Zljie8V0YgzIyYwxiKWU6xXal2Wnw4RDRF616K3VozB4IAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"사투리변환기\"\n        title=\"\"\n        src=\"/static/42cd408979776e21fe2c3a86858b9d95/f21e7/image.png\"\n        srcset=\"/static/42cd408979776e21fe2c3a86858b9d95/c26ae/image.png 158w,\n/static/42cd408979776e21fe2c3a86858b9d95/6bdcf/image.png 315w,\n/static/42cd408979776e21fe2c3a86858b9d95/f21e7/image.png 360w\"\n        sizes=\"(max-width: 360px) 100vw, 360px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<figcaption>\n어따 심심해서 저기 GPT성님헌티 전라도말씨로 바꿔달라헸단께요. 비타오스~\n</figcatipn>\n</figure>\n<p>지난 시간에는 리덕수 그잡채에 대해 알아봤는디라 기억할런가 몰것네잉</p>\n<p>이전에 살펴본 Redux는<br>\n액션 타입이 그냥 문자열이라 오타날 확률도 높고, 뭐가 있는지도 헷갈릴 수 있었지라<br>\n데이터랑 상태가 많을수록 store라는 중앙집권식 객체가 점점 커질께<br>\n그리고 state를 직접 건드리면 안된다는 규칙을 개발자가 알아서 지켜야 혀<br>\n이런 문제를 뭐.. 상수 선언하던지, 리듀서를 나눠가지고 해결할 수도 있긴 한디<br>\n이거를 다 간단하게 해결해주는 Redux Toolkit이 나왔당께</p>\n<p><a href=\"https://ko.redux.js.org/redux-toolkit/overview/\">리덕스 툴킷</a>은 효율적인 Redux 개발을 위한 도구로써, Redux 팀에서 강력추천하는 활용법이제.<br>\nRedux의 대표적인 세 가지 문제를 해결하려고 만들어졌는디</p>\n<ul>\n<li>저장소 설정이 너무 복잡하다잉</li>\n<li>쓰다보면 다른 패키지에 의존을 많이 하게 된다잉</li>\n<li>코드양이 너무 많아진다잉</li>\n</ul>\n<p>그래서 나온 것이 리덕스 툴킷이다잉 <a href=\"https://redux-toolkit.js.org/\">https://redux-toolkit.js.org/</a><br>\n<code class=\"language-text\">npm install @reduxjs/toolkit</code><br>\n여기에는 redux가 이미 포함되어 있당께</p>\n<h2 id=\"리듀서-쪼개보기-slice\" style=\"position:relative;\"><a href=\"#%EB%A6%AC%EB%93%80%EC%84%9C-%EC%AA%BC%EA%B0%9C%EB%B3%B4%EA%B8%B0-slice\" aria-label=\"리듀서 쪼개보기 slice permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>리듀서 쪼개보기 slice</h2>\n<p>전에야 하나의 중앙 store만 있구, 그 안에서만 상태를 관리했는디<br>\n이제 <code class=\"language-text\">createSlice</code>를 사용해서 store의 분파를 만들 수 있당께. 마치 지방자치구를 만드는 것처럼 말여.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> initialState <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">counter</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">show</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> counterSlice <span class=\"token operator\">=</span> <span class=\"token function\">createSlice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">\"counter\"</span><span class=\"token punctuation\">,</span>\n  initialState<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">reducers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">increment</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      state<span class=\"token punctuation\">.</span>counter<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">decrement</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      state<span class=\"token punctuation\">.</span>counter<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">increase</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> amount <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      state<span class=\"token punctuation\">.</span>counter <span class=\"token operator\">+=</span> amount<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">toggle</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      state<span class=\"token punctuation\">.</span>show <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>state<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이렇게</p>\n<ul>\n<li><code class=\"language-text\">name</code> : 지방자치구 이름</li>\n<li><code class=\"language-text\">initialState</code> : 초기 상태값\n<ul>\n<li>\"lazy initialize\"라서, state 값이 <code class=\"language-text\">undefined</code>일 때 이게 대신 사용된다잉</li>\n</ul>\n</li>\n<li><code class=\"language-text\">reducers</code> : 액션 메서드가 들어간 객체\n<ul>\n<li><code class=\"language-text\">toggle(state)</code> 이런 식으로 작성하면, 이전 상태를 받아서 업데이트하게 할 수 있고, <code class=\"language-text\">increase(state, payload)</code>처럼 페이로드를 받아서 쓸 수도 있당께.</li>\n</ul>\n</li>\n</ul>\n<p>전에 리듀서로 <code class=\"language-text\">case</code>문 써서 <code class=\"language-text\">type</code>으로 구분했는디, 이제는 액션 메서드를 따로 만들어서 쓰면 된다잉.<br>\n이러면 오타날 걱정도 없구, 더 명확허게 쓸 수 있당께.</p>\n<p>그리고 중요한 점이, <strong>state를 메서드 안에서 직접 변화시키는 것</strong>인데<br>\n이거는 리덕스 툴킷이 <a href=\"https://github.com/immerjs/immer\">immer</a>라는 라이브러리를 써서 가능한 것이여.<br>\n직접 수정하는 것처럼 보이게 써도, 내부적으로 알아서 복제하고 반환하는 형태로 처리해줌께.<br>\n그러니까 그냥 <code class=\"language-text\">state.count++</code> 이런 식으로 걍 써도 된다잉.</p>\n<h2 id=\"리듀서-등록하고-store-만들기\" style=\"position:relative;\"><a href=\"#%EB%A6%AC%EB%93%80%EC%84%9C-%EB%93%B1%EB%A1%9D%ED%95%98%EA%B3%A0-store-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-label=\"리듀서 등록하고 store 만들기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>리듀서 등록하고 store 만들기</h2>\n<p>이제 <code class=\"language-text\">createSlice</code>로 만든 슬라이스는 리듀서를 완전히 대체할 수 있당께<br>\n<code class=\"language-text\">createStore(counterSlice.reducer)</code>라고 쓰면 간단하게 store를 만들 수 있당께.</p>\n<p>중앙집권적이었던 저장소를 슬라이스로 나누게 되었는디,<br>\n슬라이스가 여러 개 있을 수 있제.<br>\n이전엔 <code class=\"language-text\">combineReducer</code>로 여러 리듀서를 병합했는디,<br>\n리덕스 툴킷에선 <code class=\"language-text\">configureStore</code> 함수를 쓰면 간단혀.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token function\">configureStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">reducer</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">counter</span><span class=\"token operator\">:</span> counterSlice<span class=\"token punctuation\">.</span>reducer<span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">foo</span><span class=\"token operator\">:</span> fooSlice<span class=\"token punctuation\">.</span>reducer\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">configureStore</code>에 <code class=\"language-text\">reducer</code>라는 속성을 가진 객체를 넘겨주면,<br>\n슬라이스들을 구분하는 이름이랑 그 리듀서를 넣어주면 됨께.<br>\n그러면 자동으로 모든 슬라이스 리듀서를 합친 중앙 저장소가 만들어진당께.</p>\n<h2 id=\"action을-내보내고-컴포넌트에서-쓰기\" style=\"position:relative;\"><a href=\"#action%EC%9D%84-%EB%82%B4%EB%B3%B4%EB%82%B4%EA%B3%A0-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EC%97%90%EC%84%9C-%EC%93%B0%EA%B8%B0\" aria-label=\"action을 내보내고 컴포넌트에서 쓰기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>action을 내보내고 컴포넌트에서 쓰기</h2>\n<p><code class=\"language-text\">slice</code>의 actions 객체에는 <code class=\"language-text\">reducers:</code>에서 정의한 액션 메서드들이 다 들어있당께.<br>\n이제 액션 메서드들을 내보내면 되는데, 이건 다 <strong>액션 생성자</strong>로 보면 된다잉.<br>\n이전에는 <code class=\"language-text\">{ type: \"increment\" }</code> 이런 액션 객체를 직접 만들어서 <code class=\"language-text\">dispatch</code>했는디,<br>\n이제는 <code class=\"language-text\">counterSlice.actions.increment</code>를 호출하면 알아서 <code class=\"language-text\">{ type: \"increment\" }</code>를 내보낸당께.<br>\n그리고 <code class=\"language-text\">counterSlice.actions</code>를 내보내서 컴포넌트에서 갖다 쓰면 됨께.</p>\n<p><code class=\"language-text\">export const counterActions = counterSlice.actions;</code> 이런 식으로 action 생성자를 내보낼 수 있다잉.</p>\n<p>이제 <code class=\"language-text\">dispatch(counterActions.increment)</code> 이렇게 쓰면 된다잉.<br>\n페이로드를 넣고 싶으면 <code class=\"language-text\">counterActions.increase(10)</code> 이런 식으로 쓰면 됨께.</p>\n<h2 id=\"useselector로-상태값-가져오기\" style=\"position:relative;\"><a href=\"#useselector%EB%A1%9C-%EC%83%81%ED%83%9C%EA%B0%92-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0\" aria-label=\"useselector로 상태값 가져오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useSelector로 상태값 가져오기</h2>\n<p>슬라이스 여러 개를 <code class=\"language-text\">configureStore</code>로 합쳤다면,<br>\n<code class=\"language-text\">useSelector</code>에서 저 reducer 객체의 키 값으로 상태를 찾아야 한당께.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> counter <span class=\"token operator\">=</span> <span class=\"token function\">useSelector</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>counter<span class=\"token punctuation\">.</span>counter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> showCounter <span class=\"token operator\">=</span> <span class=\"token function\">useSelector</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>counter<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> isAuthenticated <span class=\"token operator\">=</span> <span class=\"token function\">useSelector</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">.</span>authenticated<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이런 식으로 철저하게 구분돼있당께.<br>\n이제 <code class=\"language-text\">store.fooCounter.counter</code> 같은 식으로도 손쉽게 상태를 관리할 수 있제.</p>\n<hr>\n<h1 id=\"비동기-처리나-부수효과를-redux에서-다루기\" style=\"position:relative;\"><a href=\"#%EB%B9%84%EB%8F%99%EA%B8%B0-%EC%B2%98%EB%A6%AC%EB%82%98-%EB%B6%80%EC%88%98%ED%9A%A8%EA%B3%BC%EB%A5%BC-redux%EC%97%90%EC%84%9C-%EB%8B%A4%EB%A3%A8%EA%B8%B0\" aria-label=\"비동기 처리나 부수효과를 redux에서 다루기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>비동기 처리나 부수효과를 Redux에서 다루기</h1>\n<p>리덕스에 몇 가지 제약이 있었는디</p>\n<ul>\n<li>리듀서 함수는 순수해야 하고, 부수효과가 없고, 동기적으로 동작해야 한다는 것이제.</li>\n</ul>\n<p>그래서 HTTP 요청이나 비동기 로직 같은 것들은</p>\n<ul>\n<li>컴포넌트 안에서 <code class=\"language-text\">useEffect</code>로 처리하던가,</li>\n<li>Redux Toolkit의 Thunk를 사용해서 처리할 수 있당께.</li>\n</ul>\n<h3 id=\"useeffect로-처리하기\" style=\"position:relative;\"><a href=\"#useeffect%EB%A1%9C-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\" aria-label=\"useeffect로 처리하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useEffect로 처리하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> cart <span class=\"token operator\">=</span> <span class=\"token function\">useSelector</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state</span> <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>cart<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://my-firebase-url/cart.json</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">method</span><span class=\"token operator\">:</span> <span class=\"token string\">\"PUT\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">body</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>cart<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>cart<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이렇게 <code class=\"language-text\">useEffect</code>를 사용해서 상태 변화에 따른 부수효과를 처리할 수 있당께.<br>\n근디 첫 마운트 때 비어 있는 cart를 백엔드에 보내는 문제가 있을 수 있제.</p>\n<p>이걸 해결하려면 컴포넌트 함수 바깥에 <code class=\"language-text\">let isInitial = true</code>를 선언해서 첫 마운트 때는 HTTP 요청을 하지 않게 설정할 수 있다잉.</p>\n<h2 id=\"액션-생성자-thunk-사용하기\" style=\"position:relative;\"><a href=\"#%EC%95%A1%EC%85%98-%EC%83%9D%EC%84%B1%EC%9E%90-thunk-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"액션 생성자 thunk 사용하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>액션 생성자 Thunk 사용하기</h2>\n<p>Thunk는 어떤 작업을 지연시키는 함수라 보면 된다잉.<br>\n비동기 요청이나 다른 액션을 처리할 수 있당께.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">sendCartData</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">cartData</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">async</span> <span class=\"token parameter\">dispatch</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 여기에 다른 액션을 dispatch하거나 비동기 요청을 처리함께.</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이런 식으로 액션 생성자 안에 비동기 로직을 넣어 처리할 수 있다잉.</p>\n<p>예를 들어, 상태 변화에 따른 HTTP 요청과 알림 액션을 추가하는 로직을 이렇게 작성할 수 있당께.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">sendCartData</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">cartData</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">async</span> <span class=\"token parameter\">dispatch</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">sendRequest</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://my-firebase-url/cart.json</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">method</span><span class=\"token operator\">:</span> <span class=\"token string\">\"PUT\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">body</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>cartData<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>response<span class=\"token punctuation\">.</span>ok<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Sending cart data failed.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">await</span> <span class=\"token function\">sendRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span>\n      uiActions<span class=\"token punctuation\">.</span><span class=\"token function\">showNotification</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 알림 payload</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이제 컴포넌트에서 <code class=\"language-text\">dispatch(sendCartData(cart));</code> 이렇게 써서 비동기 작업을 처리할 수 있다잉.</p>\n<p>마찬가지로, 첫 마운트 때 데이터를 가져오는 Thunk도 만들 수 있제.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchCartData</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">async</span> <span class=\"token parameter\">dispatch</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchData</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https://my-firebase-url/cart.json\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>response<span class=\"token punctuation\">.</span>ok<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">return</span> data<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> cartData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span>cartActions<span class=\"token punctuation\">.</span><span class=\"token function\">replaceCart</span><span class=\"token punctuation\">(</span>cartData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">/* 에러 처리 */</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이제 컴포넌트에서 <code class=\"language-text\">useEffect(()=>{ dispatch(fetchCartData()) }, []);</code><br>\n이렇게 간단히 한 줄로 처리할 수 있당께.</p>\n<hr>\n<p><br>\n리덕수씨네 툴킷 워땐겨? 덕분에 더 깔끔하고 편리해졌지라<br>\n이만 마치겄소</p>","frontmatter":{"title":"아따 시방부터 리덕수 툴킷에 대해 알아볼텨 (Redux Toolkit)","date":"September 30, 2024","description":"Redux Toolkit.","tag":["TIL","React","Redux"]},"tableOfContents":"<ul>\n<li>\n<ul>\n<li><a href=\"#%EB%A6%AC%EB%93%80%EC%84%9C-%EC%AA%BC%EA%B0%9C%EB%B3%B4%EA%B8%B0-slice\">리듀서 쪼개보기 slice</a></li>\n<li><a href=\"#%EB%A6%AC%EB%93%80%EC%84%9C-%EB%93%B1%EB%A1%9D%ED%95%98%EA%B3%A0-store-%EB%A7%8C%EB%93%A4%EA%B8%B0\">리듀서 등록하고 store 만들기</a></li>\n<li><a href=\"#action%EC%9D%84-%EB%82%B4%EB%B3%B4%EB%82%B4%EA%B3%A0-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EC%97%90%EC%84%9C-%EC%93%B0%EA%B8%B0\">action을 내보내고 컴포넌트에서 쓰기</a></li>\n<li><a href=\"#useselector%EB%A1%9C-%EC%83%81%ED%83%9C%EA%B0%92-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0\">useSelector로 상태값 가져오기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%B9%84%EB%8F%99%EA%B8%B0-%EC%B2%98%EB%A6%AC%EB%82%98-%EB%B6%80%EC%88%98%ED%9A%A8%EA%B3%BC%EB%A5%BC-redux%EC%97%90%EC%84%9C-%EB%8B%A4%EB%A3%A8%EA%B8%B0\">비동기 처리나 부수효과를 Redux에서 다루기</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#useeffect%EB%A1%9C-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\">useEffect로 처리하기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%95%A1%EC%85%98-%EC%83%9D%EC%84%B1%EC%9E%90-thunk-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\">액션 생성자 Thunk 사용하기</a></p>\n</li>\n</ul>\n</li>\n</ul>"},"previous":{"fields":{"slug":"/til/introducing-redux/"},"frontmatter":{"title":"Redux."}},"next":null},"pageContext":{"id":"9de55127-7456-5f3a-b8e1-2dd8ff6d2ca9","previousPostId":"35207938-89ae-5212-80af-d5732f90062e","nextPostId":null}},"staticQueryHashes":["2841359383"],"slicesMap":{}}