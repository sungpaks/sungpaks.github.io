---
title: "ğŸª¢ scipyì˜ curve_fit ì ë‹¹íˆ ì¨ë³´ê¸°"
date: 2024-05-09 23:41:56
description: "5ë¶„ì´ë©´ ë°ì´í„° ë¶„ì„ê°€(ì¸ ì²™)í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"
tag: ["Python", "Data Analysis"]
---

ê·¸ ì™œ ì´ëŸ°ê±° ë³¸ì  ìˆìœ¼ì‹œì£ ?

[![fitting ì˜ˆì‹œ](image.png)](https://www.analyticsvidhya.com/blog/2021/10/everything-you-need-to-know-about-linear-regression/)

ìœ„ì™€ ê°™ì´ ë°ì´í„°ë“¤ ë§‰.. ì°ì–´ë†“ê³ , ì ë‹¹í•œ ì„  ì­ˆìš± ê·¸ì–´ì„œ "ì´ëŸ° ë¶„í¬ë¥¼ ë”°ë¦…ë‹ˆë‹¤" ë¼ê³  í•˜ëŠ” ê²ƒ ë§ì…ë‹ˆë‹¤  
ë‹¹ì—°í•˜ì§€ë§Œ ê·¸ëƒ¥ ì‚¬ëŒì´ ëŒ€ê°• ì„ ì„ ê·¸ì–´ë‚´ëŠ”ê²Œ ì•„ë‹ˆë¼  
ì ë‹¹í•œ ìˆ˜í•™ì  ë°©ë²•ìœ¼ë¡œ ë°ì´í„°ë¥¼ ê°€ì¥ ì˜ í‘œí˜„í•˜ëŠ” í•¨ìˆ˜ë¥¼ êµ¬í•˜ê²Œ ë©ë‹ˆë‹¤

ê·¸ëŸ° ê³¼ì •ì„ ë‘ê³  *ë°ì´í„°ë¥¼ fittingí•œë‹¤*ë¼ê³  í•˜ëŠ”ë°

![ì˜·ì…ê¸°](image-1.png)

ë¬¼ë¡  ì´ë ‡ê²Œ ì˜· ì…ëŠ” ê·¸ í”¼íŒ…ì€ ì•„ë‹™ë‹ˆë‹¤

ì•„ë¬´íŠ¼ ê·¸ëŸ° ë°©ë²•ë“¤ ì¤‘ ê°€ì¥ ê¸°ì´ˆì ì¸ ì„í”Œë€íŠ¸ê°€ **Least Square** Method ì…ë‹ˆë‹¤
[![ìµœì†Œì œê³±ë²•](image-2.png)](https://youngji.medium.com/%EC%B5%9C%EC%86%8C%EC%A0%9C%EA%B3%B1%EB%B2%95-least-squared-method-f7357990329f)
ì´ëŸ° ì‹ìœ¼ë¡œ, ê·¸ëƒ¥ ì‰½ê²Œ ë§í•´ì„œ í•¨ìˆ˜ë¡œë¶€í„° ê° ì§€ì ë“¤ê¹Œì§€ì˜ ì°¨ì´ë¥¼ ìµœì†Œí™”í•˜ë ¤ëŠ” ë°©ë²•ì…ë‹ˆë‹¤  
ìì„¸í•œ ì„¤ëª…ì€ ë‚˜ë¬´ìœ„í‚¤ê°™ì€ê±°ë‚˜ [ì´ëŸ° ë°ë¥¼](https://www.geeksforgeeks.org/least-square-method/)í™•ì¸í•´ë³´ì„¸ìš”

ì•„ë¬´íŠ¼ ì´ëŸ°ê±° í•˜ë ¤ë©´ ìˆ˜ì‹ì„ ë§‰ ì„¸ì›Œì•¼í•  ê²ƒ ê°™ì§€ë§Œ  
ìš°ë¦¬ì—ê²ŒëŠ” ì½¤í‘¸íƒ€ê°€ ìˆìŠµë‹ˆë‹¤  
Pythonì„ ì“¸ê±°ê³ ,  
ê·¸ë˜í”„ ê·¸ë¦¬ëŠ” ë°ëŠ” Matplot ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼,  
ìˆ˜í•™í†µê³„ì ì¸ ê³„ì‚°ì€ scipyí•œí…Œ ë§¡ê²¨ë²„ë¦¬ê¸°ë¡œ í•©ì‹œë‹¤

# ì˜ˆì œ

1ë¶€í„° 10ê¹Œì§€ì˜ xê°’ê³¼ ê·¸ì— ëŒ€ì‘í•˜ëŠ” y, ê·¸ë¦¬ê³  yerr(yê°’ì˜ ì˜¤ì°¨)ê°€ ì•„ë˜ì™€ ê°™ì´ ì£¼ì–´ì¡Œë‹¤ê³  í•´ë´…ì‹œë‹¤

```
1 0.000105532 5.12821e-05
2 0.000281377 5.12821e-05
3 0.000437138 5.12821e-05
4 0.000595329 5.12821e-05
5 0.000623162 5.12821e-05
6 0.000735304 5.12821e-05
7 0.000838319 5.12821e-05
8 0.000911662 5.12821e-05
9 0.00124201 5.12821e-05
10 0.00137106 5.12821e-05
```

x y yerr(ë˜ëŠ” uncertainty) ì™€ ê°™ì€ í˜•íƒœì…ë‹ˆë‹¤  
ì¼ë‹¨ ì´ê±° ê°€ì ¸ë‹¤ê°€ íŒŒì‹±ì„ ì¢€ í•´ë´…ì‹œë‹¤ :

```python
import numpy as np
import scipy.optimize as opt
import matplotlib.pyplot as plt

# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ë° íŒŒì‹±
with open("linear.dat", "r") as file:
    lines = file.readlines()

x = []
y = []
uncertainty = []
for line in lines:
    try:
        parts = line.split()
        if len(parts) < 3:
            raise ValueError("Invalid format: Insufficient data")

        x.append(float(parts[0]))
        y.append(float(parts[1]))
        uncertainty.append(float(parts[2]))
    except ValueError as e: # í˜¹ì‹œ ë¹ˆ ë¬¸ìì—´ ë“± í¬ë§·ì— ë§ì§€ ì•ŠëŠ” í–‰ì´ ë‚˜ì˜¤ë©´ ë„˜ê¹€
      # ë³„ ì¼ ì•ˆí•  ê²ƒì„
```

ì´ëŸ°ê±° ë§¤ë²ˆ ê¸°ì–µ ì•ˆ ë‚˜ë„ GPTí•œí…Œ ""linear.dat"íŒŒì¼ ì—´ì–´ì„œ ì €ëŸ° í¬ë§· íŒŒì‹±í•´ì¤˜" í•˜ë©´ ì•Œì•„ì„œ ì§œì¤ë‹ˆë‹¤.  
ì´ë ‡ê²Œ í•´ì„œ ê° x, y, uncertainty ë°°ì—´ë“¤ì„ ë§Œë“¤ì–´ë‘ë„ë¡ í•©ì‹œë‹¤

ê·¼ë° ë°ì´í„°ê°€ ëŒ€ì¶© ì–´ë–»ê²Œ ìƒê²¨ë¨¹ì—ˆëŠ”ì§€ ì•Œì•„ì•¼ ì–´ë–¤ ëª¨ì–‘ì— ë§ì¶œì§€ë„ ì•Œ ìˆ˜ ìˆê² ì£ ?  
ì ì„ ì°ì–´ë´…ì‹œë‹¤

```python
plt.errorbar(x,y, yerr=uncertainty, fmt='o')
```

ì´ëŸ¬ë©´ yì˜¤ì°¨ì™€ í•¨ê»˜ ë°ì´í„° ê·¸ë˜í”„ë¥¼ ì°ì–´ì£¼ê³ , `fmt='o'` ì˜µì…˜ìœ¼ë¡œ ì¸í•´ ë°ì´í„°ê°€ ê·¸ëƒ¥ ë˜¥ê³¨ë±…ì´ë¡œ í‘œí˜„ë©ë‹ˆë‹¤

![original data](image-3.png)

ì§ì„  ê¸‹ê³  ì‹¶ê²Œ ìƒê²¼ì£ ?

# scipy.optimize.curve_fit

ì´ì œ ì´ ë°ì´í„°ë“¤ì„ ê°€ì¥ ì˜ í‘œí˜„í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì•Œê³  ì‹¶ì€ê±´ë°

![ë„ë¼ì—ëª½](image-4.png)

ë§ˆì¹¨ ë„ë¼ì—ëª½ì´ scipy ë¼ì´ë¸ŒëŸ¬ë¦¬ì— `curve_fit`ì´ë¼ëŠ” ì¢‹ì€ ë„êµ¬ë¥¼ ì°¾ì•„ì¤¬ìŠµë‹ˆë‹¤~  
[ê³µì‹ë¬¸ì„œ](https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html)ëŠ” ì— ë”°ë¥´ë©´ `curve_fit`ì€ least squareë¡œ fittingí•´ì£¼ëŠ” í•¨ìˆ˜ë¼ê³  í•˜ë„¤ìš”  
least squareì— ëŒ€í•´ì„œëŠ” ì•„ê¹Œ ì†Œê°œí–ˆì£ ?

ì¸ìë¡œëŠ” `scipy.optimize.curve_fit(f, xdata, ydata, ...)` ì´ëŸ° ì‹ì¸ë° (...ëŠ” optionalë“¤)

- `f` : ëª¨ë¸ í•¨ìˆ˜
  - ì§ì„ ìœ¼ë¡œ í• ê±°ë‹ˆê¹Œ $y=ax+b$ë¼ëŠ” ì§ì„ ì„ ê°€ì •í•´ë´…ì‹œë‹¤
  - ê·¸ëŸ¼ ê·¸ëƒ¥ `def fit_function(x,a,b) : return a*x+b`ì™€ ê°™ì´ ì‘ì„±í•´ë‘ê³ , ì´ í•¨ìˆ˜ë¥¼ ë„˜ê¸°ë©´ ë©ë‹ˆë‹¤
- `xdata`ì™€ `ydata`ë¥¼ ì¤€ë¹„í•´ì•¼ê² ì£ ? ë°°ì—´ ìƒíƒœë¡œ ì¤€ë¹„í•´ë‘¡ì‹œë‹¤
- `sigma` (_optional_) : ì´ê±´ *uncertainty in ydata*ë¼ëŠ”ë° ë§ˆì¹¨ ìš°ë¦¬ ë°ì´í„°ì—ëŠ” yerrì— í•´ë‹¹í•˜ëŠ” `uncertainty`ê°€ ìˆì—ˆìœ¼ë‹ˆ ì´ê±¸ ë„£ì–´ì¤ì‹œë‹¤

ê·¸ëŸ¼ ì´ì œ ì´ë ‡ê²Œ ì“°ë©´ ë©ë‹ˆë‹¤

```python
# ì„ í˜• ëª¨ë¸ í•¨ìˆ˜ ì •ì˜
def fit_function(x, a, b):
    return a * x + b

# ì„ í˜• ëª¨ë¸ fitting
popt, pcov = opt.curve_fit(fit_function, x, y, sigma=uncertainty)
```

ë¦¬í„´ê°’ì´ ê¶ê¸ˆí•œë°ìš”

- `popt` : ì•„ê¹Œ ìš°ë¦¬ê°€ ëª¨ë¸í•¨ìˆ˜ë¡œ $y=ax+b$ë¥¼ ì •ì˜í–ˆê³ , `curve_fit`ì„ ì‚¬ìš©í•˜ì—¬ ê·¸ ëª¨ë¸í•¨ìˆ˜ì˜ `a`ê°’ê³¼ `b`ê°’ì„ ì •í•˜ê³  ì‹¶ì—ˆë˜ ê²ƒì¸ë°, ì´ `a`ì™€ `b`ì— í•´ë‹¹í•˜ëŠ” ê°’ë“¤ì…ë‹ˆë‹¤.
- `pcov` : ì´ê±´ `covariance matrix`ë¼ëŠ” ê²ƒì¸ë°ìš”.. _"ë‘˜ ì´ìƒ ë³€ìˆ˜ë“¤ ê°„ì˜ í©ì–´ì§„ ì •ë„(ë¶„ì‚°)ì˜ ìƒê´€ê´€ê³„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í–‰ë ¬_" ì •ë„ë¡œ ì´í•´í•˜ê³  ë„˜ì–´ê°‘ì‹œë‹¤.

![](https://i.imgur.com/LoLbvho.png)  
ê³µë¶„ì‚°í–‰ë ¬ì€ ëŒ€ì¶© ì´ë ‡ê²Œ ìƒê²¼ìŠµë‹ˆë‹¤.

ì´ `pcov`ì—ì„œ ì–»ê³ ì í•˜ëŠ” ê²ƒì€ ìš°ë¦¬ê°€ ì–»ì€ fitting ê²°ê³¼ì˜ ì˜¤ì°¨ë²”ìœ„ì¸ë°

> To compute one standard deviation errors on the parameters, useÂ `perrÂ =Â np.sqrt(np.diag(pcov))`

ë¼ëŠ” ì¹œì ˆí•œ ì„¤ëª…ì´ ìˆìŠµë‹ˆë‹¤.  
ê·¸ëŸ¼ ì´ ê²°ê³¼ë“¤ì„ ì´ìš©í•´ì„œ fitting ê²°ê³¼ë¥¼ ê·¸ë ¤ë´…ì‹œë‹¤

```python
# pcovë¡œë¶€í„° perrê°’ ê³„ì‚°
perrÂ =Â np.sqrt(np.diag(pcov))
# ë°ì´í„°ì™€ fittingëœ ëª¨ë¸ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
plt.errorbar(x, y, yerr=uncertainty, fmt='o', label="original data")
plt.plot(x, fit_function(np.array(x), *popt), label="fitted model")
plt.fill_between(x,
                 fit_function(np.array(x), *(popt - perr)),
                 fit_function(np.array(x), *(popt + perr)),
                 alpha=0.2, label="error band")
plt.legend()
plt.xlabel("x")
plt.ylabel("y")
plt.title("Linear Fitting with Error Band")
plt.show()
```

ì ë‹¹íˆ matplotìœ¼ë¡œ ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.  
ì œê°€ ì§€ê¸ˆ matplot(`plt.plot` ë“±ë“±..)ì— ëŒ€í•´ ë³„ ì„¤ëª…ì„ í•˜ì§€ ì•Šê³  ìˆëŠ”ë°  
ì €ë„ ê·¸ëƒ¥ [ê³µì‹ë¬¸ì„œ](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html)ì—ì„œ ë§¤ë²ˆ ì°¾ì•„ë´…ë‹ˆë‹¤.  
ì•„ë¬´íŠ¼ ì´ë ‡ê²Œ ì ë‹¹íˆ ê·¸ë ¤ë³´ë©´

![ê²°ê³¼](image-5.png)

ì´ë ‡ê²Œ ìˆì–´ë³´ì´ëŠ” ê²°ê³¼ê°€ ë‚˜ì™”ìŠµë‹ˆë‹¤~

---

\
ë˜ê²Œ ëœ¬ê¸ˆì—†ëŠ” ì£¼ì œì˜€ëŠ”ë°ìš”  
ë°ì´í„°ë¶„ì„ê¸°ë²•ì´ë¼ëŠ” ë¬¼ë¦¬ì²œë¬¸í•™ê³¼ ìˆ˜ì—…ì„ ë“£ë‹¤ê°€ ê·¸ëƒ¥ ì¨ë´¤ìŠµë‹ˆë‹¤

![ëª°ë¼ìš”](image-6.png)

ë¹…ë°ì´í„°ë‚˜ AIì²˜ëŸ¼ ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ë¶„ì•¼ì—ì„œ ì´ëŸ° ê²ƒë“¤ì´ ë˜ê²Œ ê¸°ì´ˆì¸ ê²ƒ ê°™ê³   
ë¬¼ë¦¬ì²œë¬¸í•™ê³¼ì—ì„œë„ ì‹¤í—˜ì´ë‚˜ ê´€ì¸¡ ë°ì´í„° ì…‹ë“¤ì„ ë‹¤ë£° ë•Œ ì´ëŸ°ê²Œ ê¸°ì´ˆë¡œ ë§ì´ë“¤ ì“°ì´ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤

ì¢€ ëŒ€ì¶© ì“´ ê²ƒ ê°™ì€ë°  
scipyì˜ `curve_fit`ì— ëŒ€í•´ ë” ì•Œì•„ë³´ê³ ì‹¶ë‹¤ë©´  
[GeeksforGeeks](https://www.geeksforgeeks.org/scipy-curve-fitting/)ê°™ì€ë°ì„œ ìì„¸íˆ ì¨ë†¨ìœ¼ë‹ˆê¹Œ ì°¸ê³ í•˜ì‹­ì…”

ì´ë§Œ ë§ˆì¹©ë‹ˆë‹¤
